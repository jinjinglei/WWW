var mo;!function(e){var t;!function(t){logger.initLogger(e.gui,"mo.gui"),logger.setLvl("mo.gui",4);var n=function(){function n(){}var r=(__define,n),a=r.prototype;return a.getAsset=function(n,r,a,i){function o(t){if("string"==typeof n){var i=e.R._resCounter[n]||0;if(0>=i&&!e.R._globalMap.hasOwnProperty(n)){var o=path.extname(n),u=!0;if(o){logger.RES.debug(n,s);var l=e.R._unloadHandlerMap[o];l&&(l(n),u=!1)}u&&RES.destroyRes(n)}}r.call(a,t,n)}var s=e.R.moduleName,u=n;if(n.prototype&&(u=new n),u instanceof egret.DisplayObject||u instanceof egret.Texture)o(u);else if("string"==typeof n){if(0==n.indexOf("pre_"))return o(null);var l=path.extname(n);if(l)l=l.toLocaleLowerCase(),".arm"!=l&&e.R.addToCfg(n,l);else{var c=RES.getRes(n);c||t.warn("资源【%s】未被预加载，请检查！",n)}e.R.countRes(n,s);try{RES.hasRes(n)?RES.getResAsync(n,o,this):RES.getResByUrl(n,o,this,RES.ResourceItem.TYPE_IMAGE)}catch(d){t.error("资源加载出错--->",d),o(null)}}else o(u)},n}();t.AssetAdapter=n,egret.registerClass(n,"mo.gui.AssetAdapter",["egret.gui.IAssetAdapter"])}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){function t(t){return e.moduleConfig[t]}function n(t){t&&(e._validModuleFunc=t)}function r(t){e._moduleNotFoundFunc=t}e.moduleConfig={};var a=function(){function e(e){var t=this;t.name=e,t.subModules=[],t.resMap={},t.fullScrSBM=!1;var n=e.indexOf("Scene");t.isSubModule=!(n>=0&&n==e.length-5)}var t=(__define,e);t.prototype;return e}();e.ModuleInfo=a,egret.registerClass(a,"mo.ModuleInfo");var i=function(n){function r(){n.apply(this,arguments)}__extends(r,n);var i=(__define,r),o=i.prototype;return o._initProp=function(){n.prototype._initProp.call(this);var e=this;e._moduleStack=[],e._LoadingClassMap={}},o.registerLoadingClass=function(e,t){this._LoadingClassMap[e]=t},o.isSubModule=function(e){return e.indexOf("Scene")!=e.length-5},o.runModule=function(e,t,n){var r=Array.prototype.slice.call(arguments,0);r.splice(0,0,!0),this._runModule.apply(this,r)},o.pushModule=function(e,t,n){var r=Array.prototype.slice.call(arguments,0);r.splice(0,0,!1),this._runModule.apply(this,r)},o._runModule=function(n,r,i,o){var s=this,u=t(r);if(i=i||{},u){var l,c,d,h,g=!1;if(l=s.curModule,l&&(c=l.target),e._validModuleFunc&&!e._validModuleFunc(u,i))return;if(!u._valid||u._valid(i)!==!1){var f=u.targetClass,p=f.__className;d=new a(p),g=d.isSubModule,d.fullScrSBM=g&&u.fullScr,u.notOwnRes&&(d.notOwnRes=u.notOwnRes),l&&(i.fromWhere=l.name);var v=s._LoadingClassMap[u.loadingType],_=v?v.create():null,m=u._preAsync||function(e,t){t()},y=_&&_.toHideUnder,C=function(){s._chgModuleResName(d),m(i,function(t){if(t)return s.curModule=l,s._chgModuleResName(l),c&&!c.parent&&c.reshow(),void(_?_.close():e.stopWaiting());if(g){if(d.parentModule=l,l.subModules.push(d),l.curSubModule=d,d.fullScrSBM)var r=s._recordTrayInfo(l.target)}else s.curModule=d;h=d.target=new f;var a=h.emitter;a&&a.once("dtor",function(t){var n=this.moduleInfo,a=n.parentModule;if(console.log("释放模块--->",n.name),e.R.unloadModule(n.name),a)for(var i=a.subModules,o=0;o<i.length;++o){var u=i[o];if(u==n){if(i.splice(o,1),i.length>0){if(a.curSubModule=i[i.length-1],a.curSubModule.target.visible=!0,e.moduleMgr.curModule.name==a.name&&(s._chgModuleResName(a.curSubModule),n.fullScrSBM)){for(var l=0,c=-1,o=0;o<i.length;++o){var u=i[o];u.fullScrSBM&&(l++,c=o)}var d=l>0;if(d){var h=a.target.getTray("dlg"),g=i[c],f=h.getElementIndex(g.target);h.numElements-1>f&&s._showTrayChildren(a.target,{dlg:r.dlg})}else s._showTrayChildren(a.target,r)}}else e.moduleMgr.curModule.name==a.name&&(s._chgModuleResName(a),n.fullScrSBM&&s._showTrayChildren(a.target,r));break}}var p=n.subModules,v=n.curSubModule;for(v&&(e.debug("释放当前子模块--->",v.name),e.R.unloadModule(v.name));p.length>0;)v=p.pop(),e.debug("释放模块--->",v.name),e.R.unloadModule(v.name)},{moduleInfo:d}),h.moduleParam=i,h.init&&h.init(),h.show(),h.visible=!1,!n&&!g&&l&&c?(c.isAutoDtor=!1,s._moduleStack.push(l)):n&&!g&&l&&(c.isAutoDtor=!0),o&&o(),process.nextTick(function(){h.visible=!0,process.nextTick(function(){process.nextTick(function(){y||!g&&c&&c.close(),_?_.close():e.stopWaiting(),d.fullScrSBM&&(r&&s._hideTrayChildren(l.target,r),d.target.visible=!0)})})})},i,r)};_?(_.emitter.once("onReady",function(){y&&!g&&c&&c.close(),n&&!g&&c&&(c.doDtor?c.doDtor():e.gui.helper._handleDoDtor(c)),C()}),_.show()):(e.playWaiting(),C())}}else e.log("没有这个模块：%s",r),e._moduleNotFoundFunc&&e._moduleNotFoundFunc(r)},o._recordTrayInfo=function(e){for(var t={},n=e._trayNames,r=0,a=n.length;a>r;r++){var i=n[r],o=e.getTray(i),s=o.numElements;s&&(t[i]=s)}return t},o._hideTrayChildren=function(e,t){for(var n in t)for(var r=t[n],a=e.getTray(n),i=a.numElements,o=Math.min(i,r),s=0,u=o;u>s;s++)a.getChildAt(s).visible=!1},o._showTrayChildren=function(e,t){for(var n in t)for(var r=t[n],a=e.getTray(n),i=a.numElements,o=Math.min(i,r),s=0,u=o;u>s;s++)a.getChildAt(s).visible=!0},o.popModule=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=this,r=n.curModule,a=n._moduleStack.pop();n.curModule=a,n._chgModuleResName(a),r.target.isAutoDtor=!0,r.target.close(),a&&a.target.reshow()},o._chgModuleResName=function(t){t.notOwnRes&&1==t.notOwnRes||(e.R.moduleName=t.name)},o.getModuleCfgItem=function(t){return e.moduleConfig[t]},o.registerModule=function(t){var n=t.id;n=n||t.targetClass.__className,t.id=n,e.moduleConfig[n]=t},o.registerValidModuleFunc=function(t){t&&(e._validModuleFunc=t)},o.registerModuleNotFoundFunc=function(t){e._moduleNotFoundFunc=t},r}(egret.Emitter);e.ModuleMgr=i,egret.registerClass(i,"mo.ModuleMgr",["mo.IModuleMgr"]);var o=function(){function e(){this.loadingType=0,this.fullScr=!1}var t=(__define,e),n=t.prototype;return n.onValid=function(e){var t=this;return t._valid=e,t},n.onPreAsync=function(e){var t=this;return t._preAsync=e,t},e.LOADING_TYPE_CIRCLE=0,e.LOADING_TYPE_ARMATURE=1,e}();e.ModuleCfgItem=o,egret.registerClass(o,"mo.ModuleCfgItem"),e.getModuleCfgItem=t,e.registerValidModuleFunc=n,e.registerModuleNotFoundFunc=r,e.moduleMgr=new i}(mo||(mo={}));var mo;!function(e){var t;!function(t){var n=function(t){function n(e,n,r){t.call(this,e),this.delegate=n,this.listName=r}__extends(n,t);var r=(__define,n),a=r.prototype;return a.newInstance=function(){var t=this,n=t.delegate,r=t.listName,a=new t.generator;if(a.delegate=n,r&&n){n._hasDtored?process.nextTick(function(){a.doDtor&&a.doDtor()}):n.emitter.once("dtor",function(){a.doDtor?a.doDtor():e.gui.helper._doDtorChildren(e.utils.getChildren(a))});var i=n["_initItem_"+r];i&&a._onAfterChildrenCreated&&a._onAfterChildrenCreated(function(){i.call(n,a)})}return a},n}(egret.gui.ClassFactory);t.DelegateFactory=n,egret.registerClass(n,"mo.gui.DelegateFactory")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t),r=n.prototype;return r.hitTestPoint=function(e,t,n){if(!this.touchEnabled)return!1;var r=egret.gui.Rect.prototype;return r.hitTestPoint.apply(this,arguments)},r.hitTest=function(e,t,n){if(!this.touchEnabled)return null;var r=egret.gui.Rect.prototype;return r.hitTest.apply(this,arguments)},t}(egret.gui.Rect);e.Rect=t,egret.registerClass(t,"mo.gui.Rect")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),this.touchEnabled=!1,this.fontFamily=this.__class.default_fontFamily}__extends(r,n);var a=__define,i=r,o=i.prototype;return o._setStyle=function(n){if(null!=n){var r=this;r._style=n;var a=e.getFontStyleOpt(n);if(a)for(var i in a){var o=a[i];null!=o&&(r[i]=o)}else t.warn("请配置名为【%s】的StyleOpt",n)}},a(o,"style",function(){return this._style},function(e){this._setStyle(e)}),a(o,"text",function(){return this._text},function(e){this._setText(e)}),a(o,"floatNum",function(){return this._floatNum},function(e){var t=this;t._floatNum=e,t._text&&null!=e&&t._setText(t._oldText)}),o._setText=function(t){var n=this;if(n._oldText=t,t instanceof Array)t=e.STR.format.apply(e.STR,[n.temp||"%s"].concat(t));else{if(t&&null!=n.floatNum&&(t=e.STR.parseNumOrStr(t+"",n.floatNum)+""),t=null==t?t:t+"",t==n._text)return;null==t||n.temp?(t=t||"",t=n.temp?e.STR.format(n.temp,t):t):t.match(/\%s/gi)&&(n.temp=t)}var r=e.ubbParser.parse(t||"",n.fontFamily||n.__class.default_fontFamily,n.size,n.textColor);"string"==typeof r?(n._text=t||"",n._textChanged=!0,n._textFlowChanged=!1,n._textFlow=[],n.invalidateProperties(),n.invalidateSize(),n.invalidateDisplayList()):n.textFlow=r},r.default_fontFamily="SimSun",r}(egret.gui.Label);t.Label=n,egret.registerClass(n,"mo.gui.Label")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(e){var t;!function(e){e.ON_SHOW="onShow",e.ON_CLOSE="onClose"}(t=e.evt||(e.evt={}))}(t=e.gui||(e.gui={}))}(mo||(mo={}));var egret;!function(e){var t;!function(e){e.isPack=!0,e.registerValueHandler(function(t){e.setValue(t,"isPack",!0)})}(t=e.project||(e.project={}))}(egret||(egret={}));var mo;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments),this.data={}}__extends(t,e);var n=(__define,t),r=n.prototype;return r._initProp=function(){e.prototype._initProp.call(this);var t=this;t.emitter=new egret.Emitter,t.delayArr=[],t.delayKeyMap={},t.oldMap={},t.chgMap={}},r.delay=function(e,t,n,r){var a=this,i=a.delayArr,o=a.delayKeyMap;o[e]||(o[e]=!0,i.push([t,n,r||[]]))},r.doDelay=function(){for(var e=this,t=e.delayArr;t.length;){var n=t.shift(),r=n.shift(),a=n.shift();r.apply(a,n)}e.delayKeyMap={}},t}(egret.Emitter);t.CompOpt=n,egret.registerClass(n,"mo.gui.CompOpt");var r=function(n){function r(){n.call(this),this._initProp()}__extends(r,n);var a=__define,i=r,o=i.prototype;return r.create=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e._baseConstFuncPrototype.create.apply(this,arguments)},r.getInstance=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e._baseConstFuncPrototype.getInstance.apply(this,arguments)},r.purgeInstance=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e._baseConstFuncPrototype.purgeInstance.apply(this,arguments)},a(o,"data",function(){return this._compOpt.data}),o._isValueChanged=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];for(var n=0,r=e.length;r>n;n++)if(this._compOpt.chgMap[e[n]])return!0;return!1},o._initProp=function(){t.helper._handleInitProp(this)},o.init=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},o.doDtor=function(){t.helper._handleDoDtor(this)},o.dtor=function(){t.helper._handleDtor(this)},o._parentChanged=function(e){return t.helper._handleSetParent(this,egret.gui.SkinnableContainer,e)},o.$setParent=function(e){return t.helper._handleSetParent(this,egret.gui.SkinnableContainer,e)},o.registerClassByKey=function(t,n,r){e.utils.registerClassByKey(this,t,n,r)},o.onEmitter=function(t,n,r){e.utils.onEmitter(this,t,n,r)},o._onResume=function(){},o.onEnter=function(){t.helper._handleOnEnter(this)},o.onExit=function(){t.helper._handleOnExit(this)},o.partAdded=function(e,r){n.prototype.partAdded.call(this,e,r),t.helper._handlePartAdded(this,e,r)},o.childrenCreated=function(){n.prototype.childrenCreated.call(this);var e=this,t=e._compOpt;t.hasChildrenCreated=!0,e._childrenCreated(),t.doDelay(),e.onEnter()},o._childrenCreated=function(){},o.setOnly=function(e,n){return t.helper._handleSetter(this,e,n,!0),this},o.set=function(e,n){return t.helper._handleSetter(this,e,n),this},o.get=function(e){return this._compOpt.data[e]},o.setData=function(e){var n=this;return t.helper._handleSetData(n,e||{}),n},o.setDataOnly=function(e){var t=this;for(var n in e)t.setOnly(n,e[n]);return t},o.dataChanged=function(){},o.refreshList=function(e){var t=this,n=t[e],r=t["_data_"+e];r&&(r="function"==typeof r?r.call(t):r,n.dataProvider=new egret.gui.ArrayCollection(r))},r}(egret.gui.SkinnableContainer);t.Comp=r,egret.registerClass(r,"mo.gui.Comp")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}__extends(n,t);var r=(__define,n),a=r.prototype;return a._initProp=function(){t.prototype._initProp.call(this),e.gui.helper.setCompSkinName(this)},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this,n=e.rect_touch,r=e.ico_border;!n&&r&&(n=e.rect_touch=r),n&&(n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e._onTip,e),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e._onClick&&e._onClick.call(e._onClickCtx,e,t.target,e._onClickData)},e))},a._getTipData=function(){return{}},a._onTip=function(e){var t=this,n=t._Tip;n&&(t.tipEnabled||t.data.tipEnabled)&&n.show(t._getTipData(),e.target)},a.onClick=function(e,t,n){this._onClick=e,this._onClickCtx=t,this._onClickData=n||{}},a.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this;e.setGray(e.data.gray)},a.setGray=function(t){var n=this.ico;return n&&e.utils.bcsh(n,t?"0,0,-100,0":null),this},n}(e.gui.Comp);t.Ico=n,egret.registerClass(n,"mo.gui.Ico")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),this._initProp()}__extends(r,n);var a=(__define,r),i=a.prototype;return r.create=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e._baseConstFuncPrototype.create.apply(this,arguments)},r.getInstance=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e._baseConstFuncPrototype.getInstance.apply(this,arguments)},r.purgeInstance=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e._baseConstFuncPrototype.purgeInstance.apply(this,arguments)},i._initProp=function(){t.helper._handleInitProp(this)},i.init=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},i.doDtor=function(){t.helper._handleDoDtor(this)},i.dtor=function(){t.helper._handleDtor(this)},i._parentChanged=function(e){return t.helper._handleSetParent(this,egret.gui.UIAsset,e)},i.$setParent=function(e){return t.helper._handleSetParent(this,egret.gui.UIAsset,e)},i.registerClassByKey=function(t,n,r){e.utils.registerClassByKey(this,t,n,r)},i.onEmitter=function(t,n,r){e.utils.onEmitter(this,t,n,r)},i._onResume=function(){},i.onEnter=function(){t.helper._handleOnEnter(this)},i.onExit=function(){t.helper._handleOnExit(this)},i.childrenCreated=function(){n.prototype.childrenCreated.call(this);var e=this,t=e._compOpt;t.hasChildrenCreated=!0,e._childrenCreated(),t.doDelay(),e.onEnter()},i._childrenCreated=function(){},r}(egret.gui.UIAsset);t.UIAsset=n,egret.registerClass(n,"mo.gui.UIAsset")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),this._initProp()}__extends(r,n);var a=(__define,r),i=a.prototype;return r.create=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e._baseConstFuncPrototype.create.apply(this,arguments)},r.getInstance=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e._baseConstFuncPrototype.getInstance.apply(this,arguments)},r.purgeInstance=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e._baseConstFuncPrototype.purgeInstance.apply(this,arguments)},i._initProp=function(){t.helper._handleInitProp(this),this.isAutoDtor=!1},i.init=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},i.doDtor=function(){t.helper._handleDoDtor(this)},i.dtor=function(){t.helper._handleDtor(this),delete this._afterChildrenCreated},i._parentChanged=function(e){return t.helper._handleSetParent(this,egret.gui.SkinnableContainer,e)},i.$setParent=function(e){return t.helper._handleSetParent(this,egret.gui.SkinnableContainer,e)},i.registerClassByKey=function(t,n,r){e.utils.registerClassByKey(this,t,n,r)},i.onEmitter=function(t,n,r){e.utils.onEmitter(this,t,n,r)},i._onResume=function(){},i.onEnter=function(){t.helper._handleOnEnter(this)},i.onExit=function(){t.helper._handleOnExit(this)},i.partAdded=function(e,r){n.prototype.partAdded.call(this,e,r),t.helper._handlePartAdded(this,e,r)},i._childrenCreated=function(){},i._onAfterChildrenCreated=function(e){this._afterChildrenCreated=e},i.setOnly=function(e,n){return t.helper._handleSetter(this,e,n,!0),this},i.set=function(e,n){return t.helper._handleSetter(this,e,n),this},i.get=function(e){return this._compOpt.data[e]},i.setData=function(e){var t=this;e=e||{};for(var n in e)t.set(n,e[n]);return t},i.setDataOnly=function(e){var t=this;for(var n in e)t.setOnly(n,e[n]);return t},i.dataChanged=function(){n.prototype.dataChanged.call(this);var e=this,t=e._compOpt;t.hasChildrenCreated||(t.hasChildrenCreated=!0,e._childrenCreated(),e._afterChildrenCreated&&e._afterChildrenCreated(),t.doDelay(),e.onEnter()),e._useSetData&&e.setData(e.data)},i.onLongClick=function(e,t,n){var r=this;r._longItor=e,r._longEnd=t,r._longCtx=n},i.refreshList=function(e){var t=this,n=t[e],r=t["_data_"+e];r&&(r="function"==typeof r?r.call(t):r,n.dataProvider=new egret.gui.ArrayCollection(r))},r}(egret.gui.ItemRenderer);t.ItemRenderer=n,egret.registerClass(n,"mo.gui.ItemRenderer")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(t){var n=function(){function e(){}var t=(__define,e),n=t.prototype;return n.dtor=function(){var e=this;delete e.scene,delete e.onClose,delete e.onCloseCtx},e}();t.LayerOpt=n,egret.registerClass(n,"mo.gui.LayerOpt");var r=function(r){function a(){r.apply(this,arguments)}__extends(a,r);var i=__define,o=a,s=o.prototype;return i(s,"trayName",function(){return this._trayName}),s.dtor=function(){r.prototype.dtor.call(this);var e=this;e._layerOpt.dtor(),delete e._layerOpt},s._setModuleParam=function(e){this._moduleParam=e},i(s,"moduleParam",function(){var e=this,t=e._layerOpt,n=t.scene;return e._moduleParam?e._moduleParam:n?n.moduleParam||{}:{}},function(e){this._setModuleParam(e)}),s._setPenetrable=function(e){this._penetrable=e;var t=this._layerOpt.rect;t&&(t.visible=e)},i(s,"penetrable",function(){return this._penetrable},function(e){this._setPenetrable(e)}),s._setActivated=function(n){var r=this,a=r._layerOpt;if(!r._hasDtored){var i=a.scene;if(n&&i&&i.canBeActivated&&!i.canBeActivated(r)&&(n=!1),a.activated!=n){void 0===a.activatedOld&&(a.activatedOld=!!a.activated),a.activated=n,t.log("_setActivated--->",r.__className,r.hashCode,n);var o=a.activateUnderDisabled;r.activated?!o&&!r.penetrable&&i&&i.inactivateUnder&&i.inactivateUnder(r):!o&&i&&i.activateUnder&&i.activateUnder(r),r._hasDtored||process.nextTick(function(){if(!r._hasDtored){var t=a.activatedOld;delete a.activatedOld;var n=a.activated;if(t!=n){n?r._onActivated():r._onInactivated();var i=n?e.activatedEmitter:e.inactivatedEmitter;i.emit(r.__className,r)}}})}}},i(s,"activated",function(){return this.parent&&this.visible&&this._layerOpt.activated},function(e){this._setActivated(e)}),s._onActivated=function(){},s._onInactivated=function(){},s._initProp=function(){r.prototype._initProp.call(this);var e=this;e._layerOpt=new n,e._trayName="display",e.penetrable=!0,e._layerOpt.isAutoSize=!0,e.alpha=0},s._childrenCreated=function(){r.prototype._childrenCreated.call(this);var t=this,n=t._layerOpt,a=n.rect=new e.gui.Rect;if(a.name="__rect",a.width=t.width,a.height=t.height,a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.x=t.width/2,a.y=t.height/2,a.alpha=0,a.visible=!t.penetrable,n.shownWithAction&&(a.scaleX=a.scaleY=1.2),!t.contentGroup){var i=t.contentGroup=new egret.gui.Group;i.id=i.name="contentGroup",egret.DisplayObjectContainer.prototype.addChildAt.call(t,i),i.width=t.width,i.height=t.height}t.contentGroup.addElement(a),t.alpha=1},s.init=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},s.partAdded=function(e,t){r.prototype.partAdded.call(this,e,t);var n=this,a=egret.TouchEvent.TOUCH_TAP;if("btn_close"==e&&t.addEventListener(a,n.close,n),"container"==e){var i=t.btn_close;i&&i.addEventListener(a,n.close,n)}},s.getTrayInfo=function(){var e=this,n=e.get("tray");return n?{tray:n}:t.getTrayInfo(e.trayName)},s._onShowReady=function(){var e=this,t=e._layerOpt,n=t.rect;n&&(n.scaleX=n.scaleY=1.2),t.showingWithAction=!1,e.visible=!0,e.activated=!0,e.emitter.emitBoth("onReady")},s._getShowAction=function(t){var n=this;n.scaleX=n.scaleY=.85;var r=e.scaleTo(.4,1).setEase(e.Ease.backOut);return e.sequence(r,e.callFunc(t))},s._showing=function(){var t=this,n=arguments[arguments.length-1];if(t._layerOpt.shownWithAction){var r=t._getShowAction(function(){t._onShowReady(),n()});e.ACT.run(t,r),t.visible=!0}else process.nextTick(function(){t._onShowReady(),n()})},s.isInTray=function(){var e=this.getTrayInfo().tray;return!!e.name&&0==e.name.indexOf("tray_")},s.show=function(){var t=this;if(!t._hasDtored){var n=t._layerOpt,r=t.getTrayInfo(),a=r.tray,i=r.scene;if(!a)return t;e.utils.stopTouch(),process.nextTick(function(){process.nextTick(function(){e.utils.resumeTouch()})}),n.scene=i,a.addElement?a.addElement(t):a.addChild(t),n.isAutoSize&&(t.width=a.width,t.height=a.height,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=a.width/2,t.y=a.height/2);var o=t.isInTray();if(!o&&n.rect&&(n.rect.visible=!1),o&&n.shownWithAction){var s=n.rect;s&&(s.scaleX=s.scaleY=1.2),n.showingWithAction=!0,t.scaleX=t.scaleY=1}return e.dispatchEventWidthCallback([[e.visibleDispatcher,t.__className],[t,gEventType.visible]],t._showing,t),t.emitter.emit(e.gui.evt.ON_SHOW,t),e.showEmitter.emit(t.__className,t),t}},s.onClose=function(e,t){var n=this._layerOpt;return n.onClose=e,n.onCloseCtx=t,this},s.close=function(){var n=this,r=n._layerOpt;if(n._hasDtored)return n;n.activated=!1;var a=r.onClose,i=r.onCloseCtx;return t.helper.rm(n),a&&a.call(i,n),n.emitter.emit(e.gui.evt.ON_CLOSE,n),e.closeEmitter.emit(n.__className,n),n},s.hide=function(){var e=this;return e.visible=!1,e.activated=!1,e},s.onEnter=function(){r.prototype.onEnter.call(this);var e=this._layerOpt;e.needToRefresh&&(this._onRefresh(),e.needToRefresh=!1)},s.onExit=function(){r.prototype.onExit.call(this),this._layerOpt.needToRefresh=!0},s._onRefresh=function(){},a.show=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this;r.create().setData(e).show()},a}(t.Comp);t.Layer=r,egret.registerClass(r,"mo.gui.Layer")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(t){var n=function(t){function n(){t.call(this),this.touchEnabled=!1}__extends(n,t);var r=__define,a=n,i=a.prototype;return r(i,"text",function(){return this._text},function(e){this._setText(e)}),i._setText=function(t){var n=this;t=null==t?t:t+"",t!=n._text&&(null==t||n.temp?(t=t||"",t=n.temp?e.STR.format(n.temp,t):t):t.match(/\%s/gi)&&(n.temp=t),n._text=t||"",n._textChanged=!0,n._textFlowChanged=!1,n._textFlow=[],n.invalidateProperties(),n.invalidateSize(),n.invalidateDisplayList())},n}(egret.gui.BitmapLabel);t.BitmapLabel=n,egret.registerClass(n,"mo.gui.BitmapLabel")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t),r=n.prototype;return r._initProp=function(){e.prototype._initProp.call(this);var t=this;t._trayName="menu",t.touchEnabled=!1},t}(e.Layer);e.MenuLayer=t,egret.registerClass(t,"mo.gui.MenuLayer")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t),r=n.prototype;return r._initProp=function(){e.prototype._initProp.call(this);var t=this;t._trayName="dlg",t._layerOpt.shownWithAction=!0,t.penetrable=!1},r._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this,n=t._layerOpt.rect;n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.outsideClosable&&t.close()},t),n.fillColor=0,n.alpha=.65},t}(e.Layer);e.Dlg=t,egret.registerClass(t,"mo.gui.Dlg")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}__extends(n,t);var r=__define,a=n,i=a.prototype;return r(i,"trayName",function(){return this._isOnTop?"top":this._trayName}),i._initProp=function(){t.prototype._initProp.call(this);var n=this;n._btnNames=[],n._trayName="msg",n.toPauseGuide=!0,n.emitter.on(e.gui.evt.ON_CLOSE,function(){n.toPauseGuide&&e.emitter.emit("resumeGuide")})},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var n=this;n.setDlgParam(n.dlgParam),n.setMsgInfo(n.msgData,n.msgArgs),n.toPauseGuide&&e.emitter.emit("pauseGuide")},i.setMsgInfo=function(t,n){var r=this;r.type=t.type,"function"==typeof n[n.length-1]?(r._onEnd=n.pop(),r._onEndCtx=null):"function"==typeof n[n.length-2]&&(r._onEndCtx=n.pop(),r._onEnd=n.pop());var a=n[n.length-1];a&&"object"==typeof a&&(r.extArg=n.pop(),r._handleExtArg(a));var i=[t.text];i=i.concat(n),r._time=t.time,r._isOnTop=!!t.onTop,r.setOnly("msg",e.STR.format.apply(e.STR,i));var o=r.dlgParam.onInfo;o&&o(r)},i._handleExtArg=function(e){},i.setDlgParam=function(t){var n=this,r=n._btnNames;null!=t.toPauseGuide&&(n.toPauseGuide=!!t.toPauseGuide);for(var a=0,i=r.length;i>a;a++){var o=r[a],s=n[o];if(s){var u=t[o];s.visible=!!u,s&&u&&(u.text&&(s.label=u.text),s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var t=this.btnInfo;t.notToClose||n.close();var r=t.event;r&&e.msgMgr.emit_type(r,n.type);var a=t.moduleToPush;a&&e.moduleMgr.pushModule(a);var i=t.listener;if(i&&i.call(t.ctx,n),t.callEnd){var o=n._onEnd;o&&o.call(n._onEndCtx)}},{name:o,btnInfo:u}))}}},i.close=function(){var n=this;return n.type&&null!=e._msgDlgWaitingMap[n.type]&&(e._msgDlgWaitingMap[n.type]=!1),t.prototype.close.call(this)},n.show=function(e,t,n){var r=new this;r.msgData=e,r.msgArgs=t,r.dlgParam=n||{},r.show()},n}(t.Dlg);t.MsgDlg=n,egret.registerClass(n,"mo.gui.MsgDlg")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t),r=n.prototype;return r._initProp=function(){e.prototype._initProp.call(this);var t=this;t._trayName="top",t.penetrable=!1},t}(e.Layer);e.TopLayer=t,egret.registerClass(t,"mo.gui.TopLayer")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}__extends(n,t);var r=(__define,n),a=r.prototype;return a._initProp=function(){t.prototype._initProp.call(this);var e=this,n=e._layerOpt;n.activateUnderDisabled=!0,n.isAutoSize=!1,e.penetrable=!0},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var n=this;if(n.isLong){var r=n.dstP0,a=n.dstP1,i=n.width,o=n.height,s=e.getStage(),u=s.width;n.x=Math.min(Math.max(10+i/2,a.x),Math.min(u-10-i/2,a.x));var l=r.y-o-5;l>=30?n.y=l+o/2:n.y=a.y+(a.y-r.y)+o/2+5}else{var c=n._layerOpt.rect;c.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.close()},n),c.fillColor=0,c.alpha=.65}},n.show=function(t,n){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];var i=this.create().setData(t);if(n){i.isLong=!0,i.dstP0=n.localToGlobal(0,0),i.dstP1=n.localToGlobal(n.width/2,n.height/2);var o=function(){e.getStage().removeEventListener(egret.TouchEvent.TOUCH_END,o,this),this.close()};e.getStage().addEventListener(egret.TouchEvent.TOUCH_END,o,i),i.x=i.y=-1e3}else i._layerOpt.shownWithAction=!0,i.penetrable=!1,i._layerOpt.isAutoSize=!0;i.show()},n}(e.gui.TopLayer);t.Tip=n,egret.registerClass(n,"mo.gui.Tip")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}__extends(n,t);var r=__define,a=n,i=a.prototype;return i._setUrl=function(e){var t=this;t._url=e,t._compOpt.delay("_setUrl",function(){t.visible=!!e,t.ico_circle.source=e},t)},r(i,"url",function(){return this._url},function(e){this._setUrl(e)}),i._initProp=function(){t.prototype._initProp.call(this),this.skinName=null},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var n=this;e.ACT.run(n.grp_circle,e.repeatForever(e.rotateBy(n.duration||3,360)))},n}(t.Comp);t.CircleImg=n,egret.registerClass(n,"mo.gui.CircleImg")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(t){function n(n){var r;return t.uiScene&&(r=t.uiScene.getTray(n))?{tray:r,scene:t.uiScene}:t.infoScene&&(r=t.infoScene.getTray(n))?{tray:r,scene:t.infoScene}:{tray:e.getStage()}}var r=function(n){function r(){n.call(this);var e=this;e._initProp(),e._initTrays()}__extends(r,n);var a=(__define,r),i=a.prototype;return i._initProp=function(){var e=this;e.emitter=new egret.Emitter,e._trayNames=[],e._trays=[],e._index=0,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onEnter,e)},i.init=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},i._initTray=function(t,n){var r=this,a=new egret.gui.Group,t="tray_"+t,i=e.getStage();return a.width=i.stageWidth,a.height=i.stageHeight,a.name=t,r[t]=a,null==n?(r._trays.push(a),r.addElement(a)):(r._trays.splice(n,1,a),r.addElementAt(a,n)),a},i._initTrays=function(){for(var e=this,t=e._trayNames,n=0,r=t.length;r>n;n++){var a=t[n];e._initTray(a)}},i.getTray=function(e){return this["tray_"+e]},i.doDtor=function(){t.helper._handleDoDtor(this)},i.dtor=function(){var n=this;t.helper._handleDtor(n),n.removeEventListener(egret.Event.ADDED_TO_STAGE,n.onEnter,n),e.utils.unregisterClass(n),e.utils.unEmitter(n)},i._show=function(){var n=this;if(!t.uiStage){var r=e.getStage();t.uiStage=new egret.gui.UIStage,t.uiStage.width=r.stageWidth,t.uiStage.height=r.stageHeight,r.addChild(t.uiStage)}t.uiStage.addElementAt(n,n._index)},i.show=function(){this._show()},i.reshow=function(){this._show(),this._recover()},i.close=function(){var t=this;if(t.parent){e.gui.helper.rm(t);var n=t._recoverMap=t._recoverMap||{},r=t.hashCode,a=n[r];if(!a){a=[],n[r]=a;for(var i=t._trays,o=0,s=i.length;s>o;o++)for(var u=i[o],l=e.utils.getChildren(u),c=0,d=l.length;d>c;c++){var h=l[c];h.activated&&a.push(h)}for(var o=0,s=a.length;s>o;o++)a[o].activated=!1}}},i.onEnter=function(){var e=this;e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onExit,e),e.visible=!0},i.onExit=function(){var e=this;e.removeEventListener(egret.Event.REMOVED_FROM_STAGE,e.onExit,e)},i.registerClassByKey=function(t,n,r){e.utils.registerClassByKey(this,t,n,r)},i.onEmitter=function(t,n,r){e.utils.onEmitter(this,t,n,r)},i._parentChanged=function(e){return t.helper._handleSetParent(this,egret.gui.Group,e)},i.$setParent=function(e){return t.helper._handleSetParent(this,egret.gui.Group,e)},r.create=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e._baseConstFuncPrototype.create.apply(this,arguments)},r.getInstance=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e._baseConstFuncPrototype.getInstance.apply(this,arguments)},r.purgeInstance=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e._baseConstFuncPrototype.purgeInstance.apply(this,arguments)},i.inactivateUnder=function(t){var n=this;if(n.parent){var r=n._trays,a=[],i=!1,o=n._recoverMap=n._recoverMap||{},s=t.hashCode;if(t.parent&&!o[s]){for(var u=0;u<r.length;u++){var l=r[u],c=e.utils.getChildren(l);if(c){if(i)break;for(var d=0,h=c.length;h>d;d++){var g=c[d];if(g==t){i=!0;break}g.activated&&a.push(g)}}}if(i){o[s]=a;for(var u=0,f=a.length;f>u;u++){var p=a[u];p.activated=!1}}}}},i.activateUnder=function(e){var t=this;if(t.parent){var n=t._recoverMap=t._recoverMap||{},r=e.hashCode;for(var a in n)if(a!=r)for(var i=n[a]||[],o=0,s=i.length;s>o;o++){i[o];if(r==i[o].hashCode)return}var u=n[r];if(delete n[r],u&&u.length){var l=!0;if(!e.parent)for(var a in n){for(var c=n[a],o=0,s=c.length;s>o;o++){if(e==c[o]){c.splice(o,1);for(var d=0,h=u.length;h>d;d++){c.splice(o+d-1,0,u[d]),l=!1;break}}if(!l)break}if(!l)break}if(l)for(var o=0,s=u.length;s>o;o++)u[o].activated=!0}}},i.canBeActivated=function(t){var n=this,r=n._trays,a=!1,i=[],o=n._recoverMap;if(!o)return!0;for(var s=0,u=r.length;u>s;s++)for(var l=r[s],c=e.utils.getChildren(l),d=0,h=c.length;h>d;d++){var g=c[d];if(a){if(g.visible&&!g.penetrable){var f=o[g.hashCode];if(!f)continue;for(var p=0,v=f.length-1;v>=0;--v){var _=f[v];
if(i.indexOf(_.hashCode)){p=v;break}}return f.splice(p,1,t),!1}}else g==t?a=!0:i.push(g.hashCode)}return!0},i._recover=function(){var e=this,t=e._recoverMap=e._recoverMap||{},n=e.hashCode,r=t[n];if(r){delete t[n];for(var a=0,i=r.length;i>a;a++)r[a].activated=!0}},r}(egret.gui.Group);t.Scene=r,egret.registerClass(r,"mo.gui.Scene");var a=function(e){function n(){e.apply(this,arguments)}__extends(n,e);var r=(__define,n),a=r.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t._trayNames=["display","menu","dlg"]},a.show=function(){t.uiScene=this,this._show()},a.reshow=function(){t.uiScene=this,this._show(),this._recover()},n}(r);t.UIScene=a,egret.registerClass(a,"mo.gui.UIScene");var i=function(e){function n(){e.apply(this,arguments)}__extends(n,e);var r=(__define,n),a=r.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t._trayNames=["msg","guide","top"]},a.show=function(){t.infoScene=this,this._show()},a.reshow=function(){t.uiScene=this,this._show(),this._recover()},n}(r);t.InfoScene=i,egret.registerClass(i,"mo.gui.InfoScene"),t.getTrayInfo=n,egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){i.create().show()})}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=__define,r=t,a=r.prototype;return a._setValue=function(e){this._value=e,this._calMask()},n(a,"value",function(){return this._value},function(e){this._setValue(e)}),a._setMaxValue=function(e){this._maxValue=e},n(a,"maxValue",function(){return this._maxValue},function(e){this._setMaxValue(e),this._calMask()}),a._setDirection=function(e){this._direction=e,this._calMask()},n(a,"direction",function(){return this._direction},function(e){this._setDirection(e)}),a._initProp=function(){e.prototype._initProp.call(this);var t=this;t.skinName=null},a.onEnter=function(){e.prototype.onEnter.call(this);var t=this,n=t.thumb;n.mask||(n.mask=new egret.Rectangle),t._calMask()},a._calMask=function(){var e=this,t=e.thumb;if(t){var n=t.mask;if(n){var r=egret.gui.ProgressBarDirection,a=e.direction||r.LEFT_TO_RIGHT,i=(e.value||0)/(e.maxValue||100),o=t.width,s=t.height;a==r.LEFT_TO_RIGHT?(n.x=n.y=0,n.width=o*i,n.height=s):a==r.RIGHT_TO_LEFT?(n.x=o*(1-i),n.y=0,n.width=o*i,n.height=s):a==r.TOP_TO_BOTTOM?(n.x=n.y=0,n.width=o,n.height=s*i):a==r.BOTTOM_TO_TOP&&(n.x=0,n.y=s*(1-i),n.width=o,n.height=s*i)}}},t}(e.gui.Comp);t.ClipBar=n,egret.registerClass(n,"mo.gui.ClipBar")}(t=e.gui||(e.gui={}))}(mo||(mo={}));var mo;!function(e){var t;!function(t){var n=function(n){function r(){n.apply(this,arguments)}__extends(r,n);var a=(__define,r),i=a.prototype;return i._initProp=function(){n.prototype._initProp.call(this);var e=this;e.skinTemp="skins.game.%sSkin",e.compSkinTemp="skins.comp.%sSkin"},i.setSkinName=function(n,r){n.skinName=e.STR.format(t.helper.skinTemp,r||n.__className)},i.setCompSkinName=function(n,r){n.skinName=e.STR.format(t.helper.compSkinTemp,r||n.__className)},i.rm=function(e){var t=e.parent;t&&(t instanceof egret.gui.SkinnableContainer||t instanceof egret.gui.ItemRenderer?egret.DisplayObjectContainer.prototype.removeChild.call(t,e):t.removeElement?t.removeElement(e):t instanceof egret.gui.DataGroup||t.removeChild(e))},i.getChild=function(t,n){var r=e.utils.getChildren(t);if(0==r.length)return null;for(var a=n.split("."),i=a[0],o=n.substring(i.length+1),s=0,u=r.length;u>s;s++){var l=r[s];if(l.name==i)return o&&""!=o?this.getChild(l,o):l}for(var s=0,u=r.length;u>s;s++){var c=this.getChild(r[s],n);if(c)return c}return null},i.isIn=function(e,t,n){var r=e.globalToLocal(t,n);return t=r.x,n=r.y,t>1&&t<e.width-1&&n>1&&n<e.height-1},i.posTo=function(t,n){var r=e.p(0,0);return t.localToGlobal(0,0,r),n.globalToLocal(r.x,r.y,r),r},i.onDrag=function(t,n,r,a,i){var o=this,s=e.utils.getExtData(t,"dragOpt");s||(s={},e.utils.setExtData(t,"dragOpt",s));var u=egret.TouchEvent,l=egret.MainContext.instance.stage;if(s.dragRegistered){var u=egret.TouchEvent,l=egret.MainContext.instance.stage;t.removeEventListener(u.TOUCH_BEGIN,s.onDragBegin,null),l.removeEventListener(u.TOUCH_MOVE,s.onDragging,null),l.removeEventListener(u.TOUCH_END,s.onDragEnd,null),s.dragRegistered=!1}s.dragBegan=!1,s.onDragBegin=function(e){l.addEventListener(u.TOUCH_MOVE,s.onDragging,null),l.addEventListener(u.TOUCH_END,s.onDragEnd,null),s.dragBegan=!0,n.call(i,t,e)},s.onDragging=function(e){if(s.dragBegan){var n=o.isIn(t,e.stageX,e.stageY);r.call(i,t,e,n)}},s.onDragEnd=function(e){l.removeEventListener(u.TOUCH_MOVE,s.onDragging,null),l.removeEventListener(u.TOUCH_END,s.onDragEnd,null),s.dragBegan=!1;var n=o.isIn(t,e.stageX,e.stageY);a.call(i,t,e,n)},t.addEventListener(u.TOUCH_BEGIN,s.onDragBegin,null),s.dragRegistered=!0},i._clearLong=function(e){var t=egret.MainContext.instance.stage;tm.clearInterval(e.intervalId),tm.clearTimeout(e.timeoutId),t.removeEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e);var n=e.list;if(n){var r=n.getChildAt(0);r.removeEventListener(egret.Event.CHANGE,e.onChange,e)}e.state=0},i.onLong=function(t,n){var r=this;n=n||{};var a=e.utils.getExtData(t,"longOpt"),i=egret.TouchEvent,o=i.TOUCH_BEGIN,s=i.TOUCH_END;a?t.removeEventListener(o,a.onTouchBegin,a):(a={timeout:n.timeout||500,interval:n.interval||100,onInterval:n.onInterval,onEnd:n.onEnd,onClick:n.onClick,ctx:n.ctx,list:n.list},e.utils.setExtData(t,"longOpt"));var u=egret.MainContext.instance.stage,l=function(e){if(!(a.state>=1)){r._clearLong(a),a.state=1;var n=a.ctx,i=a.onEnd,o=Date.newDate().getTime();a.onTouchEnd=function(){r._clearLong(a);var s=Date.newDate().getTime();if(s-o<a.timeout){var u=a.onClick;u&&r.isIn(t,e.stageX,e.stageY)&&u.call(n,t)}i&&i.call(n,t)},u.addEventListener(s,a.onTouchEnd,a);var l=a.list;if(l){a.onChange=function(){var e=Date.newDate().getTime(),s=1==a.state&&e-o>a.timeout;r._clearLong(a),s&&i&&i.call(n,t)};var c=l.getChildAt(0);c.addEventListener(egret.Event.CHANGE,a.onChange,a)}a.timeoutId=tm.setTimeout4Tick(function(){if(1==a.state){var e=a.onInterval;e&&e.call(n,t),a.intervalId=tm.setInterval4Tick(function(){e&&e.call(n,t)},a.interval)}},a.timeout)}};a.onTouchBegin=function(e){l(e)},t.addEventListener(o,a.onTouchBegin,a)},i.endLong=function(t){var n=this,r=e.utils.getExtData(t,"longOpt");if(0!=r.state){n._clearLong(r);var a=r.onEnd;a&&a.call(r.ctx,t)}},i.expandLF=function(t,n,r){var a,i,o,s,r=r||{},u=e.utils,l="expandOpt",c=u.getExtData(t,l),d=u.getExtData(n,l),h=r.mainIndex;if(!c||r.init){var g=t.parent,f=g.width;a=t.x,i=n.x,o=f/2-t.width/2,s=f/2-n.width/2,u.setExtData(t,l,{srcX:a,cX:o}),u.setExtData(n,l,{srcX:i,cX:s}),h=h||0,t.x=o,n.x=s,t.visible=0==h,n.visible=1==h}else if(null!=h)o=c.cX,s=d.cX,t.x=o,n.x=s,t.visible=0==h,n.visible=1==h;else{a=c.srcX,i=d.srcX,o=c.cX,s=d.cX;var p,v,_=c.expanding,m=e.ACT;m.stop(t),m.stop(n),t.visible=!0,n.visible=!0,t.x=_?a:o,n.x=_?i:s;var y=t.y,C=n.y,E=.15,T=.07,x=r.bounce||30;_?(p=e.sequence(e.moveBy(T,e.p(-x,0)),e.moveTo(E,e.p(o,y))),v=e.sequence(e.moveBy(T,e.p(x,0)),e.moveTo(E,e.p(s,C)))):(p=e.sequence(e.moveTo(E,e.p(a-x,y)),e.moveTo(T,e.p(a,y))),v=e.sequence(e.moveTo(E,e.p(i+x,C)),e.moveTo(T,e.p(i,C)))),async.parallel([function(n){m.run(t,e.sequence(p,e.callFunc(function(){n()})))},function(t){m.run(n,e.sequence(v,e.callFunc(function(){t()})))}],function(){c.expanding=!_,r.end&&r.end.call(r.ctx,!_)})}},i.initProgress=function(t,n){var r=e.utils.getExtData(t,"progressOpt");r||(r={baseArr:[],baseValue:0,baseIndex:0,curIndex:0},e.utils.setExtData(t,"progressOpt",r));var a=n.baseArr,i=n.baseIndex,o=n.baseValue,s=r.partNum=n.partNum||50;r["float"]=n["float"]||0,s*=Math.pow(10,r["float"]),r.baseArr=a,r.baseValue=o,r.curValue=o*s,r.baseIndex=r.curIndex=i,r.onBaseChange=n.onBaseChange,r.ctx=n.ctx,r.state=0,t.maximum=a[i]*s,t.value=o*s,t.slideDuration=0,t.labelFunction=function(e,t){var n=r.labelFunction,a=Math.pow(10,r["float"]),i=Math.round(e*a/s)/a,o=Math.round(t*a/s)/a;return n?n(i,o):i+"/"+o},tm.clearInterval(r.intervalId),r.intervalId=null},i.progress=function(t,n){var r=e.utils.getExtData(t,"progressOpt");r.totalValueToAdd=n,r.intervalId||(r.end=r.end||function(){r.running=!1,tm.clearInterval(this.intervalId),delete this.intervalId},r.intervalId=tm.setInterval4Tick(function(){for(var e=r.partNum*Math.pow(10,r["float"]),n=r.baseValue*e,a=r.baseArr,i=r.baseIndex,o=a.length-1,s=r.curIndex,u=r.curValue,l=a[s]*e,c=s==i?n:0,d=r.state,h=0,g=i;s>g;g++){var f=a[g]*e;h+=f}var p=r.totalValueToAdd*e,v=u+h-n;r.running||(r.running=!0,p>v&&t.value>=t.maximum?d=1:v>p&&t.value<=c&&(d=-1));var _=s+d,m=Math.max(i,Math.min(_,o)),y=a[m]*e,C=m==i?n:0;r.state=0;var E=r.onBaseChange,T=r.ctx;if(1==d){if(s==o)return r.curValue=t.value=y,void r.end();if(p==v)return r.curValue=t.value=l,void r.end();r.curIndex=m,t.maximum=y,u=t.value=0,E&&E.call(T,1)}else if(-1==d){if(s==i)return r.curValue=t.value=C,void r.end();if(p==v)return r.curValue=t.value=c,void r.end();r.curIndex=m,t.maximum=y,u=t.value=y,E&&E.call(T,-1)}var x=y/e;x=Math.round(x);var b=p>v?1:-1,D=Math.abs(p-v);return 0==D?void r.end():(D=Math.min(x,D)*b,u=r.curValue=Math.max(C,Math.min(y,u+D)),t.value=u,void(u==y?r.state=1:u==C&&(r.state=-1)))},20))},i.getProgressLimit=function(t){for(var n=e.utils.getExtData(t,"progressOpt"),r=n.baseArr,a=n.baseIndex,i=n.baseValue,o=0,s=a;s<r.length;s++)o+=r[s];return o-i},i.sortZOrder=function(t){e.utils.getChildren(t).sort(function(e,t){return(e.zOrder||0)>(t.zOrder||0)?1:(e.zOrder||0)<(t.zOrder||0)?-1:0})},i.scrollToBoundary=function(t,n){void 0===n&&(n=!0);var r,a=e.utils.getChildren(t);if(t instanceof egret.gui.Scroller)r=t;else for(var i=0,o=a.length;o>i;i++){var s=a[i];s instanceof egret.gui.Scroller&&(r=s)}if(r){var u="off"==r.verticalScrollPolicy,l=r.viewport,c=l.measuredWidth,d=l.measuredHeight,h=r.width,g=r.height;u?r.scrollLeft=n?c-h:0:r.scrollTop=n?d-g:0}},i.scrollTo=function(t,n){for(var r,a=e.utils.getChildren(t),i=0,o=a.length;o>i;i++){var s=a[i];s instanceof egret.gui.Scroller&&(r=s)}if(r){var u,l,c,d,h,g="off"==r.verticalScrollPolicy,f=r.viewport,p=f.measuredWidth,v=f.measuredHeight,_=r.width,m=r.height,y=f.layout,C=t.dataProvider||{},E=e.utils.getChildren(f)[0],T=C.source||[],x=1;if(g){if(l=y.gap,y instanceof egret.gui.TileLayout&&(l=y.horizontalGap,x=y.rowCount||1),u=y.paddingLeft||y.padding||0,"function"==typeof n)r.scrollLeft=Math.max(0,Math.min(n(T,u,l,x)||0,p-_));else if(E){if(h=n,"number"!=typeof n&&(h=T.indexOf(n),0>h)){for(var b,i=0,o=T.length;o>i;i++){var D=T[i],M=!0;for(var O in n)if(D[O]!=n[O]){M=!1;break}if(M){b=i;break}}h=b}if(null==h)return;c=Math.floor(h/x),d=u+E.width*c+l*c,r.scrollLeft=Math.max(0,Math.min(d||0,p-_))}}else if(l=y.gap,y instanceof egret.gui.TileLayout&&(l=y.verticalGap,x=y.columnCount||1),u=y.paddingTop||y.padding||0,"function"==typeof n)r.scrollTop=Math.max(0,Math.min(n(T,u,l,x)||0,v-m));else if(E){if(h=n,"number"!=typeof n&&(h=T.indexOf(n),0>h)){for(var b,i=0,o=T.length;o>i;i++){var D=T[i],M=!0;for(var O in n)if(D[O]!=n[O]){M=!1;break}if(M){b=i;break}}h=b}if(null==h)return;c=Math.floor(h/x),d=u+E.height*c+l*c,r.scrollTop=Math.max(0,Math.min(d||0,v-m))}}},i.registerSound=function(t,n,r){var a=this;t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var i=null==r?r:e.utils.getExtData(t,"audio");0==i||(null!=i||!n||0!=n.indexOf("btn_")&&0!=n.indexOf("ico_")||(i=a.defaultAudio),i&&e.playAudio(i))},t)},i._handlePartAdded=function(t,n,r){var a=this;if(0==n.toLocaleLowerCase().indexOf("preview"))return this.rm(r),void delete t[n];var i=t._parts=t._parts||[];i.push(n),r.name=n;var o=t.get(n);if(null!=o&&r.setData)r.setData(o);else if(0==n.indexOf("label_"))o=t.get(n.substring(6)),null!=o&&(r.text=o);else if(0==n.indexOf("bar_"))o=t.get(n.substring(4)),null!=o&&(r.value=o);else if(r instanceof egret.gui.List||r instanceof egret.gui.DataGroup){var s=t["_Item_"+n];if(s||(s=r instanceof egret.gui.TabBar?egret.gui.TabBarButton:e.gui.ItemRenderer),s){var u=r.itemRenderer=new e.gui.DelegateFactory(s,t,n),l=t.delegateFactorys=t.delegateFactorys||[];l.push(u)}var c=t["_data_"+n];c&&t._compOpt.delay("_data_"+n,function(){c="function"==typeof c?c.call(t):c,r.dataProvider=new egret.gui.ArrayCollection(c)});var d=t["_click_"+n];!d||r instanceof egret.gui.DataGroup||r.addEventListener(egret.gui.ListEvent.ITEM_CLICK,d,t)}var h=t["_tap_"+n];h&&(a.registerSound(r,n),r.addEventListener(egret.TouchEvent.TOUCH_TAP,h,t));var g=t["_chg_"+n];g&&r.addEventListener(egret.Event.CHANGE,g,t)},i._handleSetter=function(e,n,r,a){var i=this,o=e._compOpt,s=o.data,u=s[n],l=typeof r,c=!("string"==l||"number"==l||"boolean"==l)||s[n]!=r;if(c){s[n]=r;var d=o.oldMap;void 0===d[n]&&(d[n]=u),e instanceof t.ItemRenderer?i._doDataChanged(e,!0):o.hasChildrenCreated?i._doDataChanged(e,a):o.delay("dataChanged",i._doDataChanged,i,e,a)}},i._handleSetData=function(e,n){var r=e._compOpt,a=r.data=r.data||{},i=r.chgMap=r.chgMap||{},o=!1;for(var s in n){var u=n[s],l=a[s],c=typeof u;a[s]=u;var d=!("string"==c||"number"==c||"boolean"==c)||l!=u;if(d){i[s]=!0,o||(o=!0);var h=e[s];h&&h.setData&&"object"==c?h.setData(u):e["label_"+s]?e["label_"+s].text=u:e["bar_"+s]&&(e["bar_"+s].value=u);var g=e["_chg_"+s];g&&"function"==typeof g&&g.call(e,u,l),r.emitter.emit(s,u,l)}}o&&(e instanceof t.ItemRenderer?(e.dataChanged(),r.chgMap={}):r.hasChildrenCreated?(e.dataChanged(),r.chgMap={}):(r.delay("dataChanged",e.dataChanged,e),r.delay("resetChgMap",function(){r.chgMap={}},e)))},i._doDataChanged=function(e,t){if(!e._hasDtored){var n=e._compOpt,r=n.data,a=n.oldMap,i=n.chgMap;for(var o in i)delete i[o];var s=!1;for(var o in a){var u=a[o],l=r[o];delete a[o];var c=typeof u,d=!("string"==c||"number"==c||"boolean"==c)||u!=l;if(d){s=!0,i[o]=!0;var h=e[o];if(h&&h.setData?h.setData(l):e["label_"+o]?e["label_"+o].text=l:e["bar_"+o]&&(e["bar_"+o].value=l),t)continue;var g=e["_chg_"+o];g&&"function"==typeof g&&g.call(e,l,u),n.emitter.emit(o,l,u)}}!t&&s&&e.dataChanged()}},i._handleInitProp=function(e){this.setSkinName(e),e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){e._compOpt.hasChildrenCreated&&e.onEnter()},e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onExit,e),e.isAutoDtor=!0,e.isDtorByParent=!0,e._compOpt=new t.CompOpt,e.emitter=new egret.Emitter},i._handleDoDtor=function(t){t._hasDtored||(t._hasDtored=!0,t.dataChanged=function(){},this._doDtorChildren(e.utils.getChildren(t)),t.dtor&&process.nextTick(function(){e.utils.unEmitter(t),t.dtor();var n=t._parts;n&&delete t._parts}))},i._handleDtor=function(t){var n=egret.MainContext.instance.stage,r=egret.Event.ACTIVATE;n.removeEventListener(r,t._onResume,t),e.removeEventListeners(t),e.utils.unregisterClass(t),delete t.delegate;var a=t.delegateFactorys;if(a)for(;a.length>0;){var i=a.pop();delete i.delegate}e.ACT.stop(t),this.rm(t);var o=t.emitter;o&&o.emit("dtor",t),e.utils.clearExtData(t)},i._doDtorChildren=function(t){if(t)for(var n=this,r=0,a=t.length;a>r;++r){var i=t[r];if(e.ACT.stop(i),i&&(i.isDtorByParent||i.isAutoDtor)&&!i._isInstance){var o=e.utils.getExtData(i,"pool");o?o.rm(i):i.doDtor?i.doDtor():n._doDtorChildren(e.utils.getChildren(i))}else!i||i.isDtorByParent||i.isAutoDtor||i._isInstance||n._doDtorChildren(e.utils.getChildren(i))}},i._handleSetParent=function(t,n,r){var a=n.prototype,i=!0;if(a._parentChanged?a._parentChanged.call(t,r):a.$setParent&&(i=a.$setParent.call(t,r)),!r){e.ACT.stop(t);var o=e.utils.getExtData(t,"pool");if(o)o.rm(t);else if(!t._isInstance&&t.isAutoDtor)t.doDtor();else if(!t._isInstance){t.factory}}return i},i._handleOnEnter=function(e){if(e.resumeEnabled){var t=egret.MainContext.instance.stage,n=egret.Event.ACTIVATE;t.removeEventListener(n,e._onResume,e),t.addEventListener(n,e._onResume,e)}},i._handleOnExit=function(e){var t=egret.MainContext.instance.stage,n=egret.Event.ACTIVATE;t.removeEventListener(n,e._onResume,e)},r}(egret.Emitter);t.Helper=n,egret.registerClass(n,"mo.gui.Helper"),t.helper=new n}(t=e.gui||(e.gui={}))}(mo||(mo={}));