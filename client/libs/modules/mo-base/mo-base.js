var mo;!function(t){var e;!function(t){function e(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=this,n=new r;return n.init&&n.init.apply(n,arguments),n}function r(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=this,n=new r;return n.initDynamic&&n.initDynamic.apply(n,arguments),n}function n(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=this;if(!r._instance){var n=r._instance=r.create.apply(r,arguments);n._isInstance=!0}return r._instance}function a(){var t=this,e=t._instance;e&&(e.doDtor&&e.doDtor(),t._instance=null)}t.create=e,t.createDynamic=r,t.getInstance=n,t.purgeInstance=a}(e=t._baseConstFuncPrototype||(t._baseConstFuncPrototype={}))}(mo||(mo={}));var egret;!function(t){var e;!function(t){t.audioEnabled=!0,t.isScatterMode=!1,t.isAutoTextures=!1,t.unitArgs={},t.httpHost="127.0.0.1",t.httpPort="8080",t.registerValueHandler(function(e){t.setValue(e,"audioEnabled",!0),t.setValue(e,"isScatterMode",!0),t.setValue(e,"isAutoTextures",!0),t.setValue(e,"unitModule"),t.setValue(e,"unitArgs"),t.setValue(e,"httpHost"),t.setValue(e,"httpPort")})}(e=t.project||(t.project={}))}(egret||(egret={}));var res;!function(t){t._jsData={}}(res||(res={}));var mo;!function(t){function e(e,r){if(r){var n=t._dc[e]=t._dc[e]||{};for(var a in r){var i=r[a];i&&(n[a]=i)}}}function r(e,r){var n=t._dc[e]||{},a=n[r];if(!a)return a;var i;if(a instanceof Array)i=a[0];else{if("object"!=typeof a)return a;i=a["@parseType"]}if("string"==typeof i&&0==i.indexOf("@")){var o=E[i];return o?(n[r]=o[0].call(o[1],a,r),n[r]):(t.error("未注册类型为【】的dcParser，请检查！",i),a)}return a}function n(t,e,r){E[t]=[e,r]}function a(t){return res._jsData[t]}function i(e,r){var n=t.getJSONWithFileName(e);return n&&n.hasOwnProperty(r)?n[r]:(t.error("亲,"+e+"这个文件木有这个ID:"+r),{})}function o(t,e){return t.split(",")[e]}function s(){var e=t.getLocalStorageItem("DeviceId",!0);return e||(e="device"+(new Date).getTime(),t.setLocalStorageItem("DeviceId",e,!0)),e}function u(e,r){if(!M){var n=egret.project;M=n["package"]+"."+n.projName+"-"+n.httpHost+":"+n.httpPort}return r=r||!1,t.STR.format("%s_%s_%s",M,r?"":t.__areaId,e)}function l(e,r,n){var a=t._getLocalStorageKeyPre(e,n);r=JSON.stringify(r),egret.localStorage.setItem(a,r)}function c(e,r){var n=t._getLocalStorageKeyPre(e,r),a=egret.localStorage.getItem(n);try{return JSON.parse(a)}catch(i){return a}}function g(e,r){var n=t._getLocalStorageKeyPre(e,r);egret.localStorage.removeItem(n)}function f(t,e,r){if(!e)return!0;r=r||Date.newDate();var n=r.getTime()-e.getTime();if(n>=864e5)return!0;var a=r.getHours(),i=e.getHours();if(a==i&&36e5>n)return!1;for(var o=0,s=t.length;s>o;o++){var u=t[o];if(a==i){if(u!=a)return!0}else if(a>i){if(a>=u&&u>i)return!0}else if(a>=u||u>i)return!0}return!1}function h(t){for(var e=t;e;){if(!e.visible)return!1;e=e.parent}return!1}function p(t){D=t||D}function v(){t._waitingPlayCount++,1==t._waitingPlayCount&&process.nextTick(function(){t._waitingPlayCount<=0||D.show()})}function _(){t._waitingPlayCount--,t._waitingPlayCount>0||(t._waitingPlayCount<0&&(t._waitingPlayCount=0),D.close())}function m(){t._waitingPlayCount=0,process.nextTick(function(){D.close()})}function d(t){for(var e in t)x[e]=t[e]}function y(t){return x[t]}logger.initLogger(t,"mo"),t.emitter=new egret.Emitter,t._dc={};var E={};t.addDc=e,t.getData=r,t.registerDcParser=n,t.getJSONWithFileName=a,t.getJSONWithFileNameAndID=i,t.getStrByOrder=o,t.getDeviceId=s;var M;t.__areaId="",t._getLocalStorageKeyPre=u,t.setLocalStorageItem=l,t.getLocalStorageItem=c,t.removeLocalStorageItem=g,t.needToRefresh=f,t.isNodeVisible=h;var D={show:function(){},close:function(){}};t.setWaitingView=p,t._waitingPlayCount=0,t.playWaiting=v,t.stopWaiting=_,t.stopWaitingForce=m;var x={};t.registerFontStyle=d,t.getFontStyleOpt=y}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=t.length;if(1>r)return"";var n=t[0],a=!0;"object"==typeof n&&(n=JSON.stringify(n),a=!1),null==n&&(n="null"),n+="";var i=1;if(a){for(var o=n.replace(/(%d)|(%i)|(%s)|(%f)|(%o)/g,function(e){if(t.length<=i)return e;var r=t[i++];return"%d"==e||"%i"==e?parseInt(r):r}),s=t.length;s>i;i++)o+="    "+t[i];return o}for(var u=1;r>u;++u){var l=t[u];l="object"==typeof l?JSON.stringify(l):l,n+="    "+l}return n}function n(e,r){function n(e){var n=e.substring(2,e.length-1),a=r[n];return null==a?(t.warn("placeholder，map中缺少变量【%s】的设置，请检查！",n),e):a}return e.replace(h,n)}function a(t,e,r){void 0===r&&(r=!0),t+="";var n=t.length,a=e.length;return n>=a?t:r?e.substring(0,a-n)+t:t+e.substring(n)}function i(t){for(var e=t.split(""),r=0,n=0;n<e.length;n++){var a=e[n];r+=o(a)?2:1}return r}function o(t){var e=/^[u4E00-u9FA5]+$/;return e.test(t)?!1:!0}function s(t,e,r){for(var n=t.split(""),a=0,i=e;i<n.length;i++){var s=n[i];if(a+=o(s)?2:1,a>r)break}return t.substring(e,i)}function u(t){t=(t+"").replace(/，/g,",").replace(/：/g,":");for(var e=t.split(","),r={},n=0;n<e.length;n++){var a=e[n];if(a){var i=a.split(":");r[i[0]]=parseInt(i[1])}}return r}function l(t,e){void 0===e&&(e=",");var r=[];if(t)for(var n=t.split(e),a=0,i=n.length;i>a;a++)r.push(parseFloat(n[a]));return r}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];if(""!=n&&-1!==t.indexOf(n))return!0}return!1}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];t=t.replace(n,"*")}return t}function f(t,r){if(!t)return t;if(0==t.search(e.NUM_EXP)){if(t.indexOf(".")>0){if(null!=r){var n=Math.pow(10,r);return Math.round(parseFloat(t)*n)/n}return parseFloat(t)}return parseInt(t)}return t}e.NUM_EXP=/(^([\-]?[\d]+)$)|(^([\-]?[\d]+\.[\d]+)$)/,e.format=r;var h=/\$\{[^\s\{\}]*\}/g;e.placeholder=n,e.fill=a,e.getStringLength=i,e.isChinese=o,e.sub=s,e.toObj=u,e.toNums=l,e.checkSensitiveWord=c,e.replaceSensitiveWord=g,e.parseNumOrStr=f}(e=t.STR||(t.STR={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(e,r){if(e&&e.length>0)for(var n=0;n<e.length;n++)if(!(e[n]instanceof r))return t.warn("element type is wrong!"),!1;return!0}function n(t,e){for(var r=0,n=t.length;n>r;r++)if(t[r]==e){t.splice(r,1);break}}function a(t,e){for(var r=0,a=e.length;a>r;r++)n(t,e[r])}function i(t){return 0==t.length?t:t.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",")}function o(t,e,r){if(r>=t.length)for(var n=r-t.length;n--+1;)t.push(void 0);return t.splice(r,0,t.splice(e,1)[0]),t}function s(t,e,r){return t[e]=t.splice(r,1,t[e])[0],t}function u(t,e){for(var r=this.list,n=0,a=r.length;a>n;++n){var i=r[n],o=-1;"object"==typeof i&&(o=i.type,i=i.name);var s=t[i],u=e[i];if("function"==typeof s&&(s=s.call(t)),"function"==typeof u&&(u=u.call(e)),u>s)return 0>=o?1:-1;if(s>u)return 0>=o?-1:1}return 0}function l(t,e,r){var n=this.list;if(!n||0==n.length)return!0;for(var a=0,i=n.length;i>a;a++){var o=n[a];if(0!=o.length){var s=o[0],u=o.slice(1,o.length),l=t[s];if("function"==typeof l&&(l=l.call(t)),u.length>0&&u.indexOf(l)<0)return!1}}return!0}function c(t){if(t)for(var e=t.length-1;e>=0;--e)null==t[e]&&t.splice(e,1)}e.verifyType=r,e.rm=n,e.rmInArr=a,e.filter=i,e.mvTo=o,e.swap=s,e.sortOption=u,e.filterOption=l,e.reset=c}(e=t.ARR||(t.ARR={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(){return egret.action.Manager.getInstance()}function n(e,n){return r().addAction(e,n),t.ACT}function a(e){return r().pauseTarget(e),t.ACT}function i(e){return r().resumeTarget(e),t.ACT}function o(e,n){return n?r().removeAction(n):r().removeAllActionsFromTarget(e),t.ACT}e.getMgr=r,e.run=n,e.pause=a,e.resume=i,e.stop=o}(e=t.ACT||(t.ACT={}))}(mo||(mo={}));var mo;!function(t){var e=function(e){function r(){e.call(this);var t=this;t._initProp(),t._init()}__extends(r,e);var n=(__define,r),a=n.prototype;return a._initProp=function(){var t=this;t._isInstance=!1,t._hasDtored=!1},a.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},a._init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},a.doDtor=function(){var t=this;t._hasDtored||(t._hasDtored=!0,t.dtor())},a.dtor=function(){},r.create=function(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];return t._baseConstFuncPrototype.create.apply(this,arguments)},r.getInstance=function(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];return t._baseConstFuncPrototype.getInstance.apply(this,arguments)},r.purgeInstance=function(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];return t._baseConstFuncPrototype.purgeInstance.apply(this,arguments)},r}(egret.EventDispatcher);t.Class=e,egret.registerClass(e,"mo.Class")}(mo||(mo={}));var gEventType;!function(t){t.visible="visible",t.invisible="invisible",t.slidePanel="slidePanel",t.newSceneVisible="newSceneVisible"}(gEventType||(gEventType={}));var mo;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e);r.prototype;return e.getBeforeEventType=function(t){return"before_"+t},e.getAfterEventType=function(t){return"after_"+t},e}(egret.Event);t.Event=e,egret.registerClass(e,"mo.Event")}(mo||(mo={}));var mo;!function(t){function e(t,e,r){var n=t._eventsMap,a=t._captureEventsMap;if(1==arguments.length){if(n)for(var i in n)delete n[i];if(a)for(var i in a)delete n[i]}else if(2==arguments.length)if("string"==typeof e)n&&n[e]&&delete n[e],a&&a[e]&&delete a[e];else{var o=e?a:n;if(o)for(var i in o)delete o[i]}else if(3==arguments.length){var o=r?a:n;o&&delete o[e]}}function r(e,r,n,a){t.removeEventListenerOnce.apply(t,arguments);var i=e._eventsMap4Once;i||(i=e._eventsMap4Once={});var o=function(i){t.removeEventListenerOnce(e,r,n,a),n.apply(a,arguments)},s=new c;s.ctx=a,s.listener=n,s.eventType=r,s.tempListener=o;var u=i[r];u||(u=i[r]=[]),u.push(s),e.addEventListener(r,o,null)}function n(t,e,r,n){var a=t._eventsMap4Once;a||(a=t._eventsMap4Once={});var i=a[e];if(i)for(var o=0;o<i.length;++o){var s=i[o];if(s.listener==r&&s.ctx==n){t.removeEventListener(e,s.tempListener,null),i.splice(o,1);break}}}function a(e,r,n,a,i,o){var s=Array.prototype.slice.call(arguments,1);s[0]=t.Event.getBeforeEventType(r),e.addEventListener.apply(e,s)}function i(e,r,n,a,i,o){var s=Array.prototype.slice.call(arguments,1);s[0]=t.Event.getAfterEventType(r),e.addEventListener.apply(e,s)}function o(e,r,n,a,i){var o=Array.prototype.slice.call(arguments,1);o[0]=t.Event.getBeforeEventType(r),e.removeEventListener.apply(e,o)}function s(e,r,n,a,i){var o=Array.prototype.slice.call(arguments,1);o[0]=t.Event.getAfterEventType(r),e.removeEventListener.apply(e,o)}function u(e,r,n){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];for(var o=e.length,s=0;o>s;++s){var u=e[s],l=u[0],c=u[1],g=t.Event.getBeforeEventType(c);if(l.willTrigger(g)){var f=new t.Event(g);f.sender=n,f.data=u[3],l.dispatchEvent(f)}}var h=r.apply(n,a);if(!h||!h.broken)for(var s=o-1;s>=0;--s){var u=e[s],l=u[0],c=u[1],p=t.Event.getAfterEventType(c);if(l.willTrigger(p)){var v=new t.Event(p);v.sender=n,v.data=h,l.dispatchEvent(v)}}}function l(e,r,n){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];for(var o=e.length,s=0;o>s;++s){var u=e[s],l=u[0],c=u[1],g=t.Event.getBeforeEventType(c);if(l.willTrigger(g)){var f=new t.Event(g);f.sender=n,l.dispatchEvent(f)}}a.push(function(){for(var r=o-1;r>=0;--r){var a=e[r],i=a[0],s=a[1],u=t.Event.getAfterEventType(s);if(i.willTrigger(u)){var l=new t.Event(u);l.sender=n,i.dispatchEvent(l)}}}),r.apply(n,a)}var c=function(){function t(){}var e=(__define,t);e.prototype;return t}();egret.registerClass(c,"_EventStore4Once"),t.removeEventListeners=e,t.addEventListenerOnce=r,t.removeEventListenerOnce=n,t.addBeforeEventListener=a,t.addAfterEventListener=i,t.removeBeforeEventListener=o,t.removeAfterEventListener=s,t.dispatchEvent=u,t.dispatchEventWidthCallback=l}(mo||(mo={}));var mo;!function(t){t.actionDispatcher=new egret.EventDispatcher,t.visibleDispatcher=new egret.EventDispatcher,t.invisibleDispatcher=new egret.EventDispatcher,t.exitDispatcher=new egret.EventDispatcher,t.enterDispatcher=new egret.EventDispatcher,t.clickDispatcher=new egret.EventDispatcher,t.cellClickDispatcher=new egret.EventDispatcher,t.widgetCtrlClickDispatcher=new egret.EventDispatcher,t.actionEmitter=new egret.Emitter,t.activatedEmitter=new egret.Emitter,t.inactivatedEmitter=new egret.Emitter,t.showEmitter=new egret.Emitter,t.closeEmitter=new egret.Emitter}(mo||(mo={}));var mo;!function(t){var e=function(t){function e(e){t.call(this);var r=this,n=r.__class;e=r.fixMatrix(e),r.copyMatrix(e.length==n.LENGTH?e:n.IDENTITY_MATRIX),r.length=n.LENGTH}__extends(e,t);var r=(__define,e),n=r.prototype;return n.reset=function(){for(var t=this,e=t.__class,r=0;r<e.LENGTH;r++)t[r]=e.IDENTITY_MATRIX[r];return t},n.adjustColor=function(t,e,r,n){var a=this;return a.adjustHue(n),a.adjustContrast(e),a.adjustBrightness(t),a.adjustSaturation(r),a},n.adjustBrightness=function(t){var e=this;e.__class;return t=e.cleanValue(t,100),0==t||isNaN(t)?e:(e.multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1]),e)},n.adjustContrast=function(t){var e=this,r=e.__class;if(t=e.cleanValue(t,100),0==t||isNaN(t))return e;var n;return 0>t?n=127+t/100*127:(n=t%1,n=0==n?r.DELTA_INDEX[t]:r.DELTA_INDEX[t<<0]*(1-n)+r.DELTA_INDEX[(t<<0)+1]*n,n=127*n+127),e.multiplyMatrix([n/127,0,0,0,.5*(127-n),0,n/127,0,0,.5*(127-n),0,0,n/127,0,.5*(127-n),0,0,0,1,0,0,0,0,0,1]),e},n.adjustSaturation=function(t){var e=this;e.__class;if(t=e.cleanValue(t,100),0==t||isNaN(t))return e;var r=1+(t>0?3*t/100:t/100),n=.3086,a=.6094,i=.082;return e.multiplyMatrix([n*(1-r)+r,a*(1-r),i*(1-r),0,0,n*(1-r),a*(1-r)+r,i*(1-r),0,0,n*(1-r),a*(1-r),i*(1-r)+r,0,0,0,0,0,1,0,0,0,0,0,1]),e},n.adjustHue=function(t){var e=this;e.__class;if(t=e.cleanValue(t,180)/180*Math.PI,0==t||isNaN(t))return e;var r=Math.cos(t),n=Math.sin(t),a=.213,i=.715,o=.072;return e.multiplyMatrix([a+r*(1-a)+n*-a,i+r*-i+n*-i,o+r*-o+n*(1-o),0,0,a+r*-a+.143*n,i+r*(1-i)+.14*n,o+r*-o+n*-.283,0,0,a+r*-a+n*-(1-a),i+r*-i+n*i,o+r*(1-o)+n*o,0,0,0,0,0,1,0,0,0,0,0,1]),e},n.concat=function(t){var e=this,r=e.__class;return t=e.fixMatrix(t),t.length!=r.LENGTH?e:(e.multiplyMatrix(t),e)},n.clone=function(){return new e(this)},n.toString=function(){return"ColorMatrix [ "+Array.prototype.join.call(this," , ")+" ]"},n.toArray=function(){return Array.prototype.slice.call(this,0,20)},n.copyMatrix=function(t){for(var e=this,r=e.__class,n=r.LENGTH,a=0;n>a;a++)this[a]=t[a];return e},n.multiplyMatrix=function(t){for(var e=this,r=[],n=0;5>n;n++){for(var a=0;5>a;a++)r[a]=this[a+5*n];for(a=0;5>a;a++){for(var i=0,o=0;5>o;o++)i+=t[a+5*o]*r[o];this[a+5*n]=i}}return e},n.cleanValue=function(t,e){return Math.min(e,Math.max(-e,t))},n.fixMatrix=function(t){void 0===t&&(t=null);var r=this,n=r.__class;return null==t?n.IDENTITY_MATRIX:(t instanceof e&&(t=t.slice(0)),t.length<n.LENGTH?t=t.slice(0,t.length).concat(n.IDENTITY_MATRIX.slice(t.length,n.LENGTH)):t.length>n.LENGTH&&(t=t.slice(0,n.LENGTH)),t)},e.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],e.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],e.LENGTH=e.IDENTITY_MATRIX.length,e}(t.Class);t.ColorMatrix=e,egret.registerClass(e,"mo.ColorMatrix")}(mo||(mo={}));var mo;!function(t){function e(t){var e=Date.newDate(),r=e.getFullYear(),n=e.getMonth()+1,a=e.getDate();return Date.newDate(r+"/"+n+"/"+a+" "+t)}function r(t,e,r){e=e||Date.newDate();var n=e.getFullYear(),a=e.getMonth()+1,i=e.getDate(),o=Date.newDate(n+"/"+a+"/"+i+" "+t);return r&&(o=Date.newDate(o.getTime()+864e5*r)),o}function n(t){var e,r=Date.newDate(t),n=Date.newDate(),a=r.getFullYear(),i=r.getMonth()+1,o=r.getDate(),s=r.getHours(),u=r.getMinutes(),l=n.getFullYear(),c=n.getHours();if(l>a)e=a+"年"+i+"月"+o+"日 "+s+":"+u;else{var g=n.getTime()-r.getTime(),f=g/36e5;if(f>c)e=i+"月"+o+"日 "+s+":"+u;else if(f>=1)e="今天 "+s+":"+u+"分";else{var h=n.getMinutes()-u;e=h>1?h+"分钟前":"刚刚"}}return e}function a(t){var e,r=parseFloat(t)/1e3;return e=null!=r?r>60&&3600>r?Math.floor(r/60)+"分钟"+Math.floor(60*(r/60-Math.floor(r/60)))+"秒":r>=3600&&86400>r?Math.floor(r/3600)+"小时"+Math.floor(60*(r/3600-Math.floor(r/3600)))+"分钟"+Math.floor(60*(60*(r/3600-Math.floor(r/3600))-Math.floor(60*(r/3600-Math.floor(r/3600)))))+"秒":Math.floor(r)+"秒":"0时0分0秒"}function i(t,e){t=Date.newDate(t);var r=t.getDay(),n=t.getHours(),a={1:"一",2:"二",3:"三",4:"四",5:"五",6:"六",7:"日"};return(e?"每天":"星期"+a[r])+" "+(n>10?n:"0"+n)+":00:00"}function o(t){"string"==typeof t&&(t=t.split(","));for(var e={1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六",7:"周日"},r=[],n=0,a=t.length;a>n;n++)r.push(e[t[n]]);return r.join("、")}function s(t,e){var r="",n=":",a=":",i="";e&&(n="时",a="分",i="秒");var o=Math.round(t/1e3),s=Math.floor(o/3600);if(s){var u=s>23;if(u&&e){var l="天",c=Math.floor(s/24);r+=(10>c?"0":"")+c+l,s-=24*c}if(r+=(10>s?"0":"")+s+n,u&&e)return r}o%=3600;var g=Math.floor(o/60),f=Math.floor(o%60);return r+((10>g?"0":"")+g)+a+((10>f?"0":"")+f)+i}function u(e,r){var n=Date.newDate(e),a=Date.newDate(r);if(n.isAfter(a)){var i=Date.newDate(a);a=n,n=i}var o=n.getMinutesBetween(a);if(0>=o)return"刚刚";if(60>o)return t.STR.format("%s分钟前",o);var s=n.getHoursBetween(a);if(24>s)return t.STR.format("%s小时前",s);var u=n.getDaysBetween(a),l=n.getMonthsBetween(a);return 7>u?t.STR.format("%s天前",u):u>=7&&1>l?t.STR.format("%s周前",Math.floor(u/7)):12>l?t.STR.format("%s月前",Math.floor(l)):t.STR.format("%s年前",Math.floor(l/12))}function l(t,e){e=Date.newDate(e);for(var r,n=e.getHours(),a=0,i=t.length;i>a;a++){var o=t[a];if(o>n){r=o;break}}return e.clearTime(),null==r&&(r=t[0],e.addDays(1)),e.setHours(r),e}t.getTimeOfToday=e,t.getDateTime=r,t.timeFormat=n,t.millisecondToDate=a,t.formatWeekdayHour=i,t.getWeekdayDesc=o,t.getTimeStr=s,t.getBetweenTimeString=u,t.getNextTime=l}(mo||(mo={}));var mo;!function(t){function e(t,e){egret.Ticker.getInstance().register(t,e)}function r(t,e){egret.Ticker.getInstance().unregister(t,e)}function n(e,r){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];t.warn("这个接口将被废弃，请使用`process.nextTick`接口！"),process.nextTick.apply(process,arguments)}function a(t,e,r){for(var n=[],a=3;a<arguments.length;a++)n[a-3]=arguments[a];var i=egret.setTimeout(function(){delete v[i],t.apply(e,n)},null,r);return v[i]=1,i}function i(t){delete v[t],egret.clearTimeout(t)}function o(){for(var t in v)delete v[t],egret.clearTimeout(t)}function s(t,e,r){var n=new egret.Timer(r);n.addEventListener(egret.TimerEvent.TIMER,t,e);var a=m++;return _[a]={timer:n,listener:t,ctx:e},n.start(),a}function u(t){var e=_[t];if(delete _[t],e){var r=e.timer;r.removeEventListener(egret.TimerEvent.TIMER,e.listener,e.ctx),r.stop()}}function l(){for(var t in v){var e=_[t];if(delete _[t],e){var r=e.timer;r.removeEventListener(egret.TimerEvent.TIMER,e.listener,e.ctx),r.stop()}}}function c(){var e=egret.MainContext.instance.stage;return t._customStageGetter&&(e=t._customStageGetter()),e instanceof egret.Stage?(e.width=e.stageWidth,e.height=e.stageHeight):(e.stageWidth=e.width,e.stageHeight=e.height),e}function g(){var e=t.getStage();return e.removeChildren(),e}function f(t,e,r){egret.action.Manager.getInstance().addAction(t,e,r)}function h(t){egret.action.Manager.getInstance().removeAction(t)}function p(t){egret.action.Manager.getInstance().removeAllActionsFromTarget(t)}var v={};t.tick=e,t.clearTick=r,t.nextTick=n,t.setTimeout=a,t.clearTimeout=i,t.clearAllTimeout=o;var _={},m=1;t.setInterval=s,t.clearInterval=u,t.clearAllInterval=l,t.getStage=c,t.clearStage=g,t.runAction=f,t.stopAction=h,t.stopAllActions=p}(mo||(mo={}));var mo_res;!function(t){function e(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var r=0,n=t.length;n>r;r++){var a=t[r];g.indexOf(a)<0&&g.push(a)}}function r(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var r=0,n=t.length;n>r;r++){var a=t[r],i=g.indexOf(a);i>=0&&g.splice(i,1)}}function n(e,r){if(!s[e]){if(!r){if(r=path.extname(e),!r)return;r=r.toLocaleLowerCase()}RES.parseConfig({resources:[{name:e,url:e,type:t.typeMap[r]}]},"resource/"),s[e]=!0}}function a(t,e){u[t.toLowerCase()]=e}function i(t,e,r){t=t instanceof Array?t:[t],async.map(t,function(t,e,r){if(!t)return r();var a=path.extname(t);if(a){if(a=a.toLowerCase(),g.indexOf(a)>=0)return r();var i=u[a];if(i)return i(t,r);if(".grp"==a){var o=path.basename(t,a);return l[o]=function(t){r()},void RES.loadGroup(o)}n(t,a)}RES.getResAsync(t,function(){r()},null)},function(){e.call(r)})}function o(t){}var s={};t.typeMap={".json":RES.ResourceItem.TYPE_JSON,".png":RES.ResourceItem.TYPE_IMAGE,".jpg":RES.ResourceItem.TYPE_IMAGE,".mp3":RES.ResourceItem.TYPE_SOUND};var u={},l={},c=RES.ResourceEvent;RES.addEventListener(c.GROUP_COMPLETE,function(t){var e=t.groupName,r=l[e];delete l[e],r&&r()},null),RES.addEventListener(c.GROUP_LOAD_ERROR,function(t){var e=t.groupName,r=l[e];delete l[e],r&&r("error")},null);var g=[];t.setIgnores=e,t.rmIgnores=r,t.addToCfg=n,t.registerHandler=a,t.load=i,t.getRes=o}(mo_res||(mo_res={}));var logger;!function(t){var e;!function(e){t.initLogger(t.RES,"mo.R"),t.setLvl("mo.R",3)}(e=t.RES||(t.RES={}))}(logger||(logger={}));var mo;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),n=r.prototype;return n._initProp=function(){t.prototype._initProp.call(this);var e=this,r=RES.ResourceItem,n=RES.ResourceEvent,a=e._grpCbMap={};e.map={},e._handlerMap={},e._unloadHandlerMap={},e._cfgHandlerMap={},e._globalMap={},e.typeMap={".json":r.TYPE_JSON,".png":r.TYPE_IMAGE,".jpg":r.TYPE_IMAGE,".mp3":r.TYPE_SOUND},e.scatteredList=[],e._ignores=[],e._keyMap={},e.moduleInfoMap={},e._resCounter={},e._waitingMap={},e._loadedMap={},RES.addEventListener(n.GROUP_COMPLETE,function(t){var e=t.groupName,r=a[e];delete a[e],r&&r()},null),RES.addEventListener(n.GROUP_LOAD_ERROR,function(t){var e=t.groupName,r=a[e];delete a[e],r&&r("error")},null)},n.registerHandler=function(t,e,r){this._handlerMap[t.toLowerCase()]=e,this._unloadHandlerMap[t.toLowerCase()]=r},n.registerCfgHandler=function(t,e){this._cfgHandlerMap[t]=e},n.setIgnores=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var t=this._ignores,r=0,n=t.length;n>r;r++){var a=t[r];t.indexOf(a)<0&&t.push(a)}},n.rmIgnores=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var t=this._ignores,r=0,n=t.length;n>r;r++){var a=t[r],i=t.indexOf(a);i>=0&&t.splice(i,1)}},n.addToCfg=function(t,e){var r=this,n=r.typeMap,a=r._keyMap;if(!a[t]){if(!e){if(e=path.extname(t),!e)return;e=e.toLocaleLowerCase()}var i=n[e],o={name:t,url:t,type:i};if(i){var s=r._cfgHandlerMap[i];s&&s(o)}RES.parseConfig({resources:[o]},"resource/"),a[t]=!0}},n.setGlobal=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var r=this,n=r._globalMap,a=0,i=t.length;i>a;++a){var o=t[a];void 0===n[o]&&(n[o]=!1)}},n.getStatusRes=function(t,e,r){var n=RES.getRes(t);return n?e.call(r,n):void this.load(t,function(){n=RES.getRes(t),e.call(r,n)})},n.washResources=function(t){for(var e=this,r=t instanceof Array?t:[t],n=[],a=e._globalMap,i=e._loadedMap,o=e._ignores,s=0,u=r.length;u>s;++s){var l=r[s];if(!(n.indexOf(l)>=0)&&"string"==typeof l){var c=path.extname(l);if(c){if(c=c.toLowerCase(),o.indexOf(c)>=0)continue;if(a[l])continue;if(i[l])continue;".grp"==c||e.addToCfg(l,c)}n.push(l)}}return n},n.load=function(t,e,r){this.loadTo(this.moduleName,t,e,r)},n.loadTo=function(t,e,r,n){for(var a=this,i=a.washResources(e),o=a._handlerMap,s=a._grpCbMap,u=a._globalMap,l=a._waitingMap,c=a._loadedMap,g=[],f=0,h=i.length;h>f;++f){var p={res:i[f],moduleName:t};g.push(p)}async.map(g,function(t,e,r){var n=t.res;if("string"==typeof n){var i=path.extname(n);if(void 0!==u[n]||a.countRes(n,t.moduleName),a.once(n,function(){r()},t),c[n])return void a.emit(n);if(l[n])return;if(logger.RES.debug("加载资源--->",n),l[n]=!0,i){var g=path.basename(n,i);i=i.toLowerCase();var f=o[i];if(f)return f(n,function(t){a._onResLoaded(t,n)});if(".grp"==i)return s[g]=function(t){a._onResLoaded(t,n)},RES.loadGroup(g)}RES.getResAsync(n,function(t,e){a._onResLoaded(t?null:"资源加载失败："+e,n)},null)}else r()},function(){r.call(n)})},n._onResLoaded=function(t,e){var r=this,n=r._globalMap,a=r._resCounter,i=r._loadedMap,o=a[e]||0;if(delete r._waitingMap[e],!t)if(void 0!==n[e])n[e]=!0,i[e]=!0;else if(0>=o){delete i[e];var s=path.extname(e),u=!0;if(s){var l=r._unloadHandlerMap[s];l&&(l(e),u=!1)}u&&RES.destroyRes(e)}else i[e]=!0;r.emit(e,t)},n.countRes=function(t,e,r){var n=this,a=n._globalMap,i=n._resCounter;if("string"==typeof t){path.extname(t);if(void 0===a[t]){e=e||n.moduleName,e=e||"default";var o=n.moduleInfoMap,s=o[e];s||(s=o[e]={}),r=null==r?1:r,s[t]=(s[t]||0)+r,i[t]=(i[t]||0)+r,i[t]>0&&logger.RES.debug("countRes--->",t,i[t])}}},n.unload=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];1==e.length&&e[0]instanceof Array&&(e=e[0]);var n=this;t=t||n.moduleName,t=t||"default";for(var a=n.moduleInfoMap,i=a[t],o=n._globalMap,s=n._resCounter,u=[],l=0,c=e.length;c>l;++l){var g=e[l],f=i[g];if(delete i[g],void 0===o[g]&&f&&s[g]&&(s[g]-=f,s[g]<=0)){delete s[g];var h=path.extname(g),p=g;h&&(h=h.toLowerCase(),".grp"==h&&(p=path.basename(g,h))),u.push(p)}}logger.RES.debug("开始释放资源---->",u);for(var v=n._unloadHandlerMap,_=n._loadedMap,l=0,c=u.length;c>l;++l){var m=u[l];delete _[m];var h=path.extname(m);if(h){var d=v[h];if(d){d(m);continue}}RES.destroyRes(u[l])}},n.unloadModule=function(t){var e=this;t=t||e.moduleName,t=t||"default";var r=e.moduleInfoMap,n=r[t],a=e._globalMap,i=e._resCounter,o=[];delete r[t];for(var s in n){var u=n[s];if(delete n[s],void 0===a[s]&&u&&i[s]&&(i[s]-=u,i[s]<=0)){delete i[s];var l=path.extname(s),c=s;l&&(l=l.toLowerCase(),".grp"==l&&(c=path.basename(s,l))),o.push(c)}}logger.RES.debug("开始释放资源---->",o);for(var g=e._unloadHandlerMap,f=e._loadedMap,h=0,p=o.length;p>h;++h){var v=o[h];delete f[v];var l=path.extname(v);if(l){var _=g[l];if(_){_(v);continue}}RES.destroyRes(o[h])}},e}(egret.Emitter);t.Res_New=e,egret.registerClass(e,"mo.Res_New"),t.R=new e}(mo||(mo={}));var mo;!function(t){function e(t){f=t}function r(t){return f?f(t):t}function n(e,r,n){t.audioEnabled&&(null==r&&(r=!1),t.R.getStatusRes(t.getAudioPath(e),function(t){t&&t.play(r),n&&n(t)}))}function a(e){t.audioEnabled&&t.R.getStatusRes(t.getAudioPath(e),function(t){t.pause()},null)}function i(e,r){t.audioEnabled&&n(e,r,function(e){e!=t._playingMusic&&(e.setVolume(h),o(),t._playingMusic=e)})}function o(){t._playingMusic&&t._playingMusic.pause()}function s(t,e){void 0===e&&(e=!0);var r=p.indexOf(t);r>=0&&r==p.length-1||(p.push([t,e]),i(t,e))}function u(){if(o(),p.pop(),0!=p.length){var t=p[p.length-1];i(t[0],t[1])}}function l(t,e){void 0===e&&(e=!0),o(),p[p.length-1]=[t,e],i(t,e)}function c(){t._playingMusic&&t._playingMusic.play()}function g(e){t.audioEnabled&&(h=e,t._playingMusic&&t._playingMusic.setVolume(e))}var f,h=1;t.registerAudioPathHandler=e,t.getAudioPath=r,t.playAudio=n,t.pauseAudio=a,t.playMusic=i,t.pauseMusic=o;var p=[];t.pushMusic=s,t.popMusic=u,t.replaceMusic=l,t.resumeMusic=c,t.setMusicVolume=g}(mo||(mo={})),Object.defineProperty(mo,"audioEnabled",{get:function(){return 0==egret.project.audioEnabled?!1:(null==mo._audioEnabled&&(mo._audioEnabled=mo.getLocalStorageItem("AudioEnabled"),null==mo._audioEnabled&&(mo.audioEnabled=!0)),mo._audioEnabled)},set:function(t){t=!!t,mo._audioEnabled=t,mo.setLocalStorageItem("AudioEnabled",t),t?mo.R.rmIgnores(".mp3"):mo.R.setIgnores(".mp3")},enumerable:!0,configurable:!0});var mo;!function(t){var e=function(){function t(){this.__class=t;var e=this;e._initProp(),e._init()}var e=(__define,t),r=e.prototype;return r._initProp=function(){var t=this;t._hasDtored=!1},r._init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},r.doDtor=function(){var t=this;t._hasDtored||(t._hasDtored=!0,t.dtor())},r.dtor=function(){},r.reset=function(){},r.clone=function(t){var e=this;return t=t||new e.__class},t.__className="Option",t}();t.Option=e,egret.registerClass(e,"mo.Option")}(mo||(mo={}));var mo;!function(t){function e(t,e,n){var a,i=0,o=0;return 1==arguments.length?(i=t.x,o=t.y):2==arguments.length?"number"==typeof e?(i=t,o=e):(a=arguments[1],i=t.x,o=t.y):(i=t,o=e),a||(a=new r),a._setX(i),a._setY(o),a}var r=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var n=__define,a=r,i=a.prototype;return i._setXDirty=function(t){t&&(this._dirty=t),this._xDirty=t},n(i,"xDirty",function(){return this._xDirty},function(t){this._setXDirty(t)}),i._setYDirty=function(t){t&&(this._dirty=t),this._yDirty=t},n(i,"yDirty",function(){return this._yDirty},function(t){this._setYDirty(t)}),i._setDirty=function(t){this._xDirty=t,this._yDirty=t,this._dirty=t},n(i,"dirty",function(){return this._dirty},function(t){this._setDirty(t)}),i._setX=function(t){var e=this;e._x!=t&&(e._setXDirty(!0),e._x=t)},n(i,"x",function(){return this._x},function(t){this._setX(t)}),i._setY=function(t){var e=this;e._y!=t&&(e._setYDirty(!0),e._y=t)},n(i,"y",function(){return this._y},function(t){this._setY(t)}),i.clone=function(t){t||(t=new r);var e=this;return t._x=e._x,t._y=e._y,t._xDirty=e._xDirty,t._yDirty=e._yDirty,t._dirty=e._dirty,t},i.neg=function(){return t.p(-this.x,-this.y)},i.add=function(e){return t.p(this.x+e.x,this.y+e.y)},i.sub=function(e){return t.p(this.x-e.x,this.y-e.y)},i.mult=function(e){return t.p(this.x*e,this.y*e)},i.midPoint=function(t){return this.add(t).mult(.5)},i.dot=function(t){return this.x*t.x+this.y*t.y},i.cross=function(t){return this.x*t.y-this.y*t.x},i.perp=function(){return t.p(this.y,-this.x)},i.rPerp=function(){return t.p(-this.y,this.x)},i.project=function(t){return t.mult(this.dot(t)/t.dot(t))},i.rotate=function(e){return t.p(this.x*e.x-this.y*e.y,this.x*e.y+this.y*e.x)},i.unrotate=function(e){return t.p(this.x*e.x+this.y*e.y,this.y*e.x-this.x*e.y)},n(i,"lengthSQ",function(){return this.dot(this)}),i.distanceSQTo=function(t){return this.sub(t).lengthSQ},i.distanceSQ=function(e){return t.warn("Point#distanceSQ已经废弃，请使用Point#distanceSQTo"),this.sub(e).lengthSQ},n(i,"length",function(){return Math.sqrt(this.lengthSQ)}),i.distanceTo=function(t){return Math.sqrt(this.distanceSQTo(t))},i.distance=function(e){return t.warn("Point#distance已经废弃，请使用Point#distanceTo"),Math.sqrt(this.distanceSQTo(e))},i.normalize=function(){return this.length?this.mult(1/this.length):t.p(0,0)},i.toAngle=function(){return Math.atan2(this.y,this.x)},r}(egret.Point);t.Point=r,egret.registerClass(r,"mo.Point"),t.p=e}(mo||(mo={}));var mo;!function(t){function e(t,e,n,a,i){return i?(i.x=t,i.y=e,i.width=n,i.height=a,i):new r(t,e,n,a)}var r=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var n=__define,a=r,i=a.prototype;return i.containsRect=function(t){if(!t)return!1;var e=this;return!(e.x>=t.x||e.y>=t.y||e.x+e.width<=t.x+t.width||e.y+e.height<=t.y+t.height)},n(i,"maxX",function(){return this.x+this.width}),n(i,"midX",function(){return this.x+this.width/2}),n(i,"maxY",function(){return this.y+this.height}),n(i,"midY",function(){return this.y+this.height/2}),i.overlaps=function(t){var e=this;return!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y)},i.union=function(e){var r=this,e=t.rect(0,0,0,0);return e.x=Math.min(r.x,e.x),e.y=Math.min(r.y,e.y),e.width=Math.max(r.x+r.width,e.x+e.width)-e.x,e.height=Math.max(r.y+r.height,e.y+e.height)-e.y,e},i.getIntersection=function(e){var r=this,n=t.rect(Math.max(r.x,e.x),Math.max(r.y,e.y),0,0);return n.width=Math.min(r.maxX,e.maxX)-n.x,n.height=Math.min(r.maxY,e.maxY)-n.y,n},i.clone=function(t){var e=this;return t||(t=new r),t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t},r}(egret.Rectangle);t.Rect=r,egret.registerClass(r,"mo.Rect"),t.rect=e}(mo||(mo={}));var mo;!function(t){function e(e,r,n){var a,i=0,o=0;return 1==arguments.length?(i=e.width,o=e.height):2==arguments.length?"number"==typeof r?(i=e,o=r):(a=arguments[1],i=e.width,o=e.height):(i=e,o=r),a=a||new t.Size,a.width=i,a.height=o,a
}var r=function(t){function e(e,r){void 0===e&&(e=0),void 0===r&&(r=0),t.call(this),this.width=e,this.height=r}__extends(e,t);var r=(__define,e),n=r.prototype;return n.clone=function(){return new e(this.width,this.height)},n.equals=function(t){return this.width==t.width&&this.height==t.height},e}(egret.HashObject);t.Size=r,egret.registerClass(r,"mo.Size"),t.size=e}(mo||(mo={}));var mo;!function(t){function e(t){return t*Math.PI/180}function r(t){return t*(180/Math.PI)}function n(e){return t.p(-e.x,-e.y)}function a(e,r){return t.p(e.x+r.x,e.y+r.y)}function i(e,r){return t.p(e.x-r.x,e.y-r.y)}function o(e,r){return t.p(e.x*r,e.y*r)}function s(t,e){return o(a(t,e),.5)}function u(t,e){return t.x*e.x+t.y*e.y}function l(t){return o(t,1/c(t))}function c(t){return Math.sqrt(g(t))}function g(t){return u(t,t)}t.degreesToRadians=e,t.radiansToDegrees=r,t.pNeg=n,t.pAdd=a,t.pSub=i,t.pMult=o,t.pMidpoint=s,t.pDot=u,t.pNormalize=l,t.pLength=c,t.pLengthSQ=g}(mo||(mo={}));var mo;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._stopCount=0}__extends(r,e);var n=(__define,r),a=n.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var r=this;r.colorMatrix=new t.ColorMatrix},a.mergeObjs=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var r,n={},a=0,i=t.length;i>a;a++){var o=t[a];for(r in o)n[r]=o[r]}return n},a.random=function(t,e){var r=Math.random();if(1==arguments.length)return Math.round(r*t);var n=e-t;return t+Math.round(r*n)},a.randomFromArr=function(t){if(0==t.length)return null;var e=this.random(t.length-1);return t[e]},a.isEmptyObj=function(t){return t?0==Object.keys(t).length:null==t},a.c3b=function(t,e,r){var n=t.toString(16),a=e.toString(16),i=r.toString(16);return parseInt((16>t?"0"+n:n)+(16>e?"0"+a:a)+(16>r?"0"+i:i),16)},a.c3bStr=function(t,e,r){var n=t.toString(16),a=e.toString(16),i=r.toString(16);return"#"+(16>t?"0"+n:n)+(16>e?"0"+a:a)+(16>r?"0"+i:i)},a.hexToInt=function(t){return t=t.replace(/^#?/,"0x"),parseInt(t)},a.setExtData=function(t,e,r){var n=t.extData=t.extData||{};if("string"==typeof e||"number"==typeof e)n[e]=r;else for(var a in e)n[e]=e[a];return this},a.getExtData=function(t,e){var r=t.extData;return r?r[e]:null},a.clearExtData=function(t){delete t.extData},a.bcsh=function(e,r){var n=this,a="bcsh";if(null==r)t.utils.setExtData(e,a,null),e.filters=[];else{var i=t.utils.getExtData(e,a);if(i==r)return;var o=t.STR.toNums(r),s=n.colorMatrix.reset().adjustColor(o[0]||0,o[1]||0,o[2]||0,o[3]||0).toArray();t.utils.setExtData(e,a,s),e.filters=[new egret.ColorMatrixFilter(s)]}},a.convertNodeToNodeSpace=function(t,e,r){var n=e.localToGlobal(r.x,r.y);return t.globalToLocal(n.x,n.y)},a.registerClassByKey=function(t,e,r,n){var a=this,i="onDataCtrls",o=a.getExtData(t,i);o||(a.setExtData(t,i,[]),o=a.getExtData(t,i));for(var s=0,u=o.length;u>s;++s){var l=o[s];if(e==l[0]&&r==l[3]&&n==l[2])return}o.push([e,r,n]),e.registerByKey(r,n,t)},a.unregisterClass=function(t){var e=this,r="onDataCtrls",n=e.getExtData(t,r);if(n)for(e.setExtData(t,r,null);n.length;){var a=n.pop();a&&a[0].unregisterByKey(a[1],a[2],t)}},a.onEmitter=function(t,e,r,n){var a=this,i="onEmitters",o=a.getExtData(t,i);o||(a.setExtData(t,i,[]),o=a.getExtData(t,i));for(var s=0,u=o.length;u>s;++s){var l=o[s];if(e==l[0]&&r==l[3]&&n==l[2])return}o.push([e,r,n]),e.on(r,n,t)},a.unEmitter=function(t){var e=this,r=e.getExtData(t,"onEmitters");if(r)for(e.setExtData(t,"onEmitters",null);r.length;){var n=r.pop();n&&n[0].un(n[1],n[2],t)}},a.getChildren=function(t){return t._children||t.$children||[]},a._stopTouchFunc=function(t){t.stopImmediatePropagation()},a.stopTouch=function(){var t=this;if(t._stopCount=t._stopCount||0,t._stopCount++,!t._stopListened&&t._stopCount>0){var e=egret.MainContext.instance.stage,r=egret.TouchEvent;e.addEventListener(r.TOUCH_BEGIN,t._stopTouchFunc,t,!0),e.addEventListener(r.TOUCH_MOVE,t._stopTouchFunc,t,!0),e.addEventListener(r.TOUCH_END,t._stopTouchFunc,t,!0),e.addEventListener(r.TOUCH_TAP,t._stopTouchFunc,t,!0),t._stopListened=!0}},a.resumeTouch=function(){var t=this;if(t._stopCount--,t._stopListened&&t._stopCount<=0){var e=egret.MainContext.instance.stage,r=egret.TouchEvent;e.removeEventListener(r.TOUCH_BEGIN,t._stopTouchFunc,t,!0),e.removeEventListener(r.TOUCH_MOVE,t._stopTouchFunc,t,!0),e.removeEventListener(r.TOUCH_END,t._stopTouchFunc,t,!0),e.removeEventListener(r.TOUCH_TAP,t._stopTouchFunc,t,!0),t._stopListened=!1,t._stopCount=0}},r}(egret.Emitter);t.Utils=e,egret.registerClass(e,"mo.Utils"),t.utils=new e}(mo||(mo={}));var mo;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var n=(__define,r),a=n.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t._map={},t._limitInfoArr=[],t.defaultLimit=2},a.register=function(t,e,r){var n=this;n._createFunc=t,n._resetFunc=e,n._saveFunc=r},a.produce=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=this,n=this,a=n._map,i=a[t]=a[t]||[],o=n.getLimit(t),s=i.length;o>=s;++s){var u=n._createFunc.apply(null,[t].concat(e));i.push(u)}},a.get=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a,i=this,o=i._map,s=o[e]=o[e]||[];s.length>0&&(a=s.pop()),a||(a=i._createFunc.apply(null,[e].concat(r)));var u=i._resetFunc;return u&&u.apply(null,[a].concat(r)),t.utils.setExtData(a,"pool",i),t.utils.setExtData(a,"poolKey",e),a},a.rm=function(e){var r=this,n=t.utils.getExtData(e,"poolKey");if(n&&!e._hasDtored){if(t.utils.setExtData(e,"poolKey",null),t.utils.setExtData(e,"pool",null),r.closed||r._hasDtored)return void(e.doDtor&&e.doDtor());var a=r.getLimit(n),i=r._map[n]=r._map[n]||[];if(i.length>=a)e.doDtor&&e.doDtor();else{var o=r._saveFunc;o&&o(n,e),i.push(e)}}},a.setLimit=function(t,e){this._limitInfoArr.push([t,e])},a.getLimit=function(t){for(var e=this._limitInfoArr,r=0,n=e.length;n>r;++r){var a=e[0];if(t.match(a[0]))return a[1]}return this.defaultLimit},a.dtor=function(){e.prototype.dtor.call(this);var t=this,r=t._map;for(var n in r){for(var a=r[n];a.length;){var i=a.pop();i&&i.doDtor&&i.doDtor()}delete r[n]}t._limitInfoArr.length=0,t._createFunc=null,t._resetFunc=null,t._saveFunc=null},a.clear=function(){var t=this,e=t._map;for(var r in e){for(var n=e[r];n.length;){var a=n.pop();a&&a.doDtor&&a.doDtor()}delete e[r]}},r}(egret.Emitter);t.Pool=e,egret.registerClass(e,"mo.Pool")}(mo||(mo={}));var mo;!function(t){function e(t){var e=t+"";return e.indexOf("&")>=0&&(e=e.replace(/&/g,"&amp;")),e.indexOf("[")>=0&&(e=e.replace(/\[/g,"&brkl;")),e.indexOf("]")>=0&&(e=e.replace(/\]/g,"&brkr;")),e}var r=function(){function t(t,e,r,n){var a=this;a.text=t,a.style={textColor:n,size:r,fontFamily:e}}var e=(__define,t);e.prototype;return t}();t.UbbTextElement=r,egret.registerClass(r,"mo.UbbTextElement",["egret.ITextElement"]);var n=function(){function e(){var t=this;t._attrNames=["color","font","size","style","bold","italic","stroke","strokeColor"],t._convertMap={color:t._convertColorFromStr,size:t._converNumberFromStr,bold:t._converBoolFromStr,italic:t._converBoolFromStr,stroke:t._converNumberFromStr,strokeColor:t._convertColorFromStr},t._keyMap={font:"fontFamily",size:"size",color:"textColor",bold:"bold",italic:"italic",stroke:"stroke",strokeColor:"strokeColor"},t._attrSetterMap={style:t._setStyle}}var n=(__define,e),a=n.prototype;return a.setAttrs=function(t,e){for(var r=this,n={},a=0,i=e.length;i>a;a++){var o=e[a],s=o.split("=");n[s[0]]=s[1]}for(var u=r._attrNames,a=0,i=u.length;i>a;a++){var l=u[a],c=n[l];if(c){var g=r._convertMap[l];g&&(c=g.call(r,t,c));var f=r._keyMap[l]||l,h=r._attrSetterMap[f];h?h.call(r,t,c):t.style[f]=c}}},a._convertColorFromStr=function(e,r){r=r.trim().toLowerCase();var n=this.__class.colorMap[r];return n?n:0==r.indexOf("#")?t.utils.hexToInt(r):0==r.indexOf("0x")?t.utils.hexToInt("#"+r.substring(2)):parseInt(r)},a._converNumberFromStr=function(t,e){return parseInt(e)},a._converBoolFromStr=function(t,e){var r=parseInt(e);return isNaN(r)?"true"==e?!0:!1:r>0?!0:!1},a._setStyle=function(e,r){var n=t.getFontStyleOpt(r),a=e.style;if(n)for(var i in n){var o=n[i];null!=o&&(a[i]=o)}},a._parseTextFromStr=function(t){var e=/\](.*)\[\/ubb\]/g,r=e.exec(t);return r?r[1]:t},a.isUBB=function(t){return t&&(-1!==t.indexOf(e.UBB_TAG)||-1!==t.indexOf(e.LINE_BREAK_TAG))},a.parse=function(t,n,a,i){var o=this;if(o.isUBB(t)){for(var s,o=this,u=/^[^\[]+|\[ubb[^\]]*?\].*?\[\/ubb\]|[^\]]+$|[^\[\]]+/g,l=t.split(e.LINE_BREAK_TAG),c=[],g=0;g<l.length;g++){var f=l[g];if(null!=f)if(g>0&&c.push(new r("\n",n,a,i)),""!=f){s=f.match(u);for(var h=0;h<s.length;h++){var p=s[h],v=new r("",n,a,i);if(o.isUBB(p)){var _=o._parseTextFromStr(p),m="]"+_+"[/ubb]";p=p.replace(m,"");var d=p.match(/[^\s]+=[^\s\]]+/gi);d&&o.setAttrs(v,d),v.text=o.trans2Normal(_)}else v.text=p==o.__class.LINE_BREAK_TAG?"\n":p;c.push(v)}}else c.push(new r(" ",n,a,i))}return c}return t},a.trans2Normal=function(t){var e=t+"";return e.indexOf("&brkl;")>=0&&(e=e.replace(/&brkl;/g,"[")),e.indexOf("&brkr;")>=0&&(e=e.replace(/&brkr;/g,"]")),e.indexOf("&amp;")>=0&&(e=e.replace(/&amp;/g,"&")),e},e.LINE_BREAK_TAG="[/br]",e.UBB_TAG="/ubb]",e.colorMap={white:16777215,yellow:16776960,blue:255,green:65280,red:16711680,magenta:16711935,black:0,orange:16744192,gray:3355443},e}();t.UBBParser=n,egret.registerClass(n,"mo.UBBParser"),t.trans4UBB=e,t.ubbParser=new n}(mo||(mo={}));var mo;!function(t){function e(){t._isScheduler4DataControllerStarted||(t._isScheduler4DataControllerStarted=!0,t.tick(function(){for(var e=t.DataController._resetList;e.length;){var r=e.pop();t.ARR.reset(r.__registers),t.ARR.reset(r.__registerTargets);var n=r.__registersForKey;for(var a in n){var i=n[a];if(!i)return;t.ARR.reset(i.registers),t.ARR.reset(i.registerTargets)}}for(var o=t.DataController._registerQueue;o.length>0;){var i=o.shift();"*"==i.eventName?i.target.notifyAll():i.target.notifyEvent(i.eventName)}},t.DataController))}var r=function(){function e(){}var r=(__define,e),n=r.prototype;return n._initBase=function(){var t=this;t.__baseInited||(t.__registers||(t.__registers=[]),t.__registerTargets||(t.__registerTargets=[]),t.__registersForKey||(t.__registersForKey={}),t.__baseInited=!0)},n.register=function(t,e){var r=this;r._initBase();for(var n=r.__registers,a=r.__registerTargets,i=0,o=n.length;o>i;++i)if(n[i]==t&&e==a[i])return;n.push(t),a.push(e)},n.registerByKey=function(t,e,r){this._initBase();var n=this.__registersForKey;n[t]||(n[t]={registers:[],registerTargets:[]});for(var a=n[t].registers,i=n[t].registerTargets,o=0,s=a.length;s>o;++o)if(a[o]==e&&r==i[o])return;a.push(e),i.push(r)},n.unregister=function(e,r){var n=this;if(n.__baseInited)for(var a=n.__registers,i=n.__registerTargets,o=0,s=a.length;s>o;o++)a[o]!=e||r&&r!=i[o]||(a[o]=null,i[o]=null,t.DataController._pushResetTarget(n))},n.unregisterByKey=function(e,r,n){var a=this;if(a.__baseInited){var i=a.__registersForKey,o=i[e];if(o)for(var s=o.registers,u=o.registerTargets,l=0;l<s.length;++l)s[l]!=r||n&&n!=u[l]||(s[l]=null,u[l]=null,t.DataController._pushResetTarget(a))}},n.unregisterAll=function(){var t=this;t.__registers.length=0,t.__registerTargets.length=0;var e=t.__registersForKey;for(var r in e)delete e[r];t._changed=!1},e}();egret.registerClass(r,"_DataControllerApi");var n=function(n){function a(){n.call(this),e()}__extends(a,n);var i=(__define,a),o=i.prototype;return o._initProp=function(){n.prototype._initProp.call(this);var t=this;t._keyChangedMap={},t._customArgMap={},t._autoNotify=!0,t._changed=!1,t._initBase()},o.reset=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.init.apply(this,arguments),this.pushNotify(this.__class.ON_RESET)},o.dtor=function(){var t=this;n.prototype.dtor.call(this),t.setAutoNotify(!1),t.unregisterAll(),null!=t.resModuleName&&(t.resModuleName=null),t._eventTarget=null},o.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];n.prototype.init.apply(this,arguments),this._data=t[0],this.setAutoNotify(!0)},o.setAutoNotify=function(t){this._autoNotify!=t&&(this._autoNotify=t)},o.isAutoNotify=function(){return this._autoNotify},o._notifyArr=function(t,e,r){if(t){for(var n=0,a=t.length;a>n;++n)t[n]&&t[n].apply(e[n],r);for(var n=0;n<t.length;)t[n]?++n:(t.splice(n,1),e.splice(n,1))}},o._setChanged=function(e){var r=this;r._changed=!0;var n="*";null!=e&&(r._keyChangedMap[e]=!0,n=e),r._autoNotify&&t.DataController._pushInv(r,n)},o.get=function(t){return this._data[t]},o.set=function(t,e){return"object"!=typeof e&&e==this._data[t]?!1:(this._setChanged(t),this._data[t]=e,!0)},o.add=function(t,e){var r=this.get(t)||0;this.set(t,r+e)},o.getData=function(){return this._data},o.updateEntity=function(t){var e=this;t=t||{};for(var r in e.DATA_KEY){var n=e.DATA_KEY[r];t.hasOwnProperty(n)&&e.set(n,t[n])}},o._cloneObj=function(t){var e={};for(var r in t)e[r]=t[r];return e},o.pushNotify=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=Array.prototype.slice.apply(arguments);t=a[0],a.splice(0,1),this._customArgMap[t]=a,this._setChanged(t)},o.pushNotifyAtOnce=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=this,i=Array.prototype.slice.apply(arguments);t=i[0],i.splice(0,1);var o={};o[t]=i,a._notifyEvent(t,a.__registersForKey,o),a._notifyEvent(t,a.__class.__registersForKey,o)},o._notifyEvent=function(t,e,r){if(e){var n=this,a=e[t];if(a&&a.registers&&a.registers.length>0){var i=r[t];i=null==i&&null!=n._data?[n._data[t]]:i,i=i||[],i.push(n),n._notifyArr(a.registers,a.registerTargets,i)}}},o.notifyEvent=function(t){var e=this;if(e._changed){var r=e._keyChangedMap,n=e._customArgMap;delete r[t],e._notifyEvent(t,e.__registersForKey,n),e._notifyEvent(t,e.__class.__registersForKey,n);var a=Object.keys(r);a&&0!=a.length||(e._changed=!1,e._notifyArr(e.__registers,e.__registerTargets,[null,e]),e._notifyArr(e.__class.__registers,e.__class.__registerTargets,[null,e]))}},o.notifyAll=function(){var t=this,e=t._cloneObj(t._keyChangedMap);for(var r in e)t.notifyEvent(r)},o._initBase=function(){r.prototype._initBase.apply(this,arguments)},o.register=function(t,e){r.prototype.register.apply(this,arguments)},o.registerByKey=function(t,e,n){r.prototype.registerByKey.apply(this,arguments)},o.unregister=function(t,e){r.prototype.unregister.apply(this,arguments)},o.unregisterByKey=function(t,e,n){r.prototype.unregisterByKey.apply(this,arguments)},o.unregisterAll=function(){r.prototype.unregisterAll.apply(this,arguments)},a._initBase=function(){r.prototype._initBase.apply(this,arguments)},a.register=function(t,e){r.prototype.register.apply(this,arguments)},a.registerByKey=function(t,e,n){r.prototype.registerByKey.apply(this,arguments)},a.unregister=function(t,e){r.prototype.unregister.apply(this,arguments)},a.unregisterByKey=function(t,e,n){r.prototype.unregisterByKey.apply(this,arguments)},a.unregisterAll=function(){r.prototype.unregisterAll.apply(this,arguments)},a._pushInv=function(e,r){for(var n=t.DataController._registerQueue,a=0;a<n.length;a++){var i=n[a];if(i.target==e&&r==i.eventName)return}n.push({target:e,eventName:r})},a._pushResetTarget=function(t){var e=this._resetList;e.indexOf(t)<0&&e.push(t)},a.ON_RESET="onReset",a._registerQueue=[],a._resetList=[],a}(egret.Emitter);t.DataController=n,egret.registerClass(n,"mo.DataController"),t._isScheduler4DataControllerStarted=!1,t._startScheduler4DataController=e}(mo||(mo={}));var mo;!function(t){function e(e){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var i=t._msgData[e];if(null==i)if(isNaN(e))r(e);else{var o=t.STR.format("未找到消息码【%s】对应的数据，请检查！",e);r(o)}else{var s=t.msgMgr.translate(i),u=s.type,l=t._MsgDlgClassMap[u],c=t._msgDlgParamMap[u];if(l){if(t._msgDlgWaitingMap[u])return!1;t._msgDlgWaitingMap.hasOwnProperty(u)&&(t._msgDlgWaitingMap[u]=!0),l.show(s,n,c)}else if(isNaN(e))r(e);else{var o=t.STR.format("未找到消息类型【%s】，请检查！",e);r(o)}}return!1}function r(e,r){t.warn(e),null==r&&(r=t.defaultMsgType);var n={};n.text=e,n.type=r;var a=t._MsgDlgClassMap[r],i=t._msgDlgParamMap[r];a&&a.show(n,[],i)}function n(e,r,n){t._MsgDlgClassMap[e]=r,t._msgDlgParamMap[e]=n}function a(e){t._msgDlgWaitingMap[e]=!1}function i(e){t._msgData=e}t._MsgDlgClassMap={},t._msgDlgParamMap={},t._msgData={},t._msgDlgWaitingMap={},t.showMsg=e,t.showErrMsg=r,t.registerMsgDlg=n,t.registerMsgWaitingDlg=a,t.setMsgData=i;var o=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),n=r.prototype;return n._initProp=function(){t.prototype._initProp.call(this);var e=this;e.translate=function(t){return t}},n.getRealEvent=function(t,e){return t+"_"+e},n.on_type=function(t,e,r,n){this.on(this.getRealEvent(t,e),r,n)},n.un_type=function(t,e,r,n){this.un(this.getRealEvent(t,e),r,n)},n.once_type=function(t,e,r,n){this.once(this.getRealEvent(t,e),r,n)},n.unOnce_type=function(t,e,r,n){this.unOnce(this.getRealEvent(t,e),r,n)},n.emit_type=function(t,e){this.emit(this.getRealEvent(t,e))},e.ON_CANCEL="onCancel",e.ON_OK="onOk",e}(egret.Emitter);t.MsgMgr=o,egret.registerClass(o,"mo.MsgMgr"),t.msgMgr=new o}(mo||(mo={}));var mo;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),n=r.prototype;return n._initProp=function(){t.prototype._initProp.call(this);var e=this;e._queue=[],e._createCount=3},n.produce=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=this._produce.apply(this,arguments);return r.reset(),r.isReclaimed=!1,r.isAutoDtor=!0,r},n.produce4Recycle=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=this.produce.apply(this,arguments);return r.isAutoDtor=!1,r},n.produceDynamic=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=this._produceDynamic.apply(this,arguments);return r.reset(),r.isReclaimed=!1,r.isAutoDtor=!0,r},n.produceDynamic4Recycle=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=this.produceDynamic.apply(this,arguments);return r.isAutoDtor=!1,r},n._produce=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r,n=this;return n._queue.length>0?r=n._queue.shift():(r=n._productClass.create.apply(n._productClass,arguments),r.setFactory(n)),r},n._produceDynamic=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r,n=this;return n._queue.length>0?(r=n._queue.shift(),arguments.length>1&&arguments[arguments.length-1](r)):(r=n._productClass.createDynamic.apply(n._productClass,arguments),r.setFactory(n)),r},n.reclaim=function(t){var e=this;if(!t.isReclaimed&&!t.isAutoDtor&&t.getFactory()==e){var r=e._queue;r.push(t),t.reset(),t.isReclaimed=!0}},n.releaseAllProducts=function(){for(var t,e=this._queue;e.length>0;)t=e.pop(),t.doDtor()},n.releaseProduct=function(t){for(var e=this._queue,r=0;r<e.length;)t==e[r]?(e.splice(r,1),t.doDtor()):r++},n.dtor=function(){t.prototype.dtor.call(this),this.releaseAllProducts()},e}(t.Class);t.BaseFactory=e,egret.registerClass(e,"mo.BaseFactory")}(mo||(mo={}));var mo;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),n=r.prototype;return n._initProp=function(){t.prototype._initProp.call(this),this._queue={}},n._init=function(){t.prototype._init.call(this)},n._produce=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n,a;return a=this._queue[t],a&&a.length>0?n=a.shift():(n=this._productClass.create.apply(this._productClass,arguments),n.setFactory(this),n._keyNameForFactory=t),n},n._produceDynamic=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n,a;return a=this._queue[t],a&&a.length>0?(n=a.shift(),n.handleDynamic.apply(n,arguments)):(n=this._productClass.createDynamic.apply(this._productClass,arguments),n.setFactory(this),n._keyNameForFactory=t),n},n.reclaim=function(t){var e=this;if(!t.isReclaimed&&!t.isAutoDtor&&t.getFactory()==e){var r=t._keyNameForFactory,n=e._queue;n.hasOwnProperty(r)||(n[r]=[]),n[r].push(t),t.reset(),t.isReclaimed=!0}},n.releaseAllProducts=function(){var t=this._queue;for(var e in this._queue){var r=t[e];if(r)for(var n;r.length>0;)n=r.pop(),n.doDtor()}},n.releaseProduct=function(t){var e=this._queue;for(var r in this._queue){var n=e[r];if(n)for(var a=0,i=n.length;i>a;a++)if(t==n[a])return n.splice(a,1),void t.doDtor()}},e}(t.BaseFactory);t.MultiIdBaseFactory=e,egret.registerClass(e,"mo.MultiIdBaseFactory")}(mo||(mo={}));